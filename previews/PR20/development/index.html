<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Development · fwlLove</title><meta name="title" content="Development · fwlLove"/><meta property="og:title" content="Development · fwlLove"/><meta property="twitter:title" content="Development · fwlLove"/><meta name="description" content="Documentation for fwlLove."/><meta property="og:description" content="Documentation for fwlLove."/><meta property="twitter:description" content="Documentation for fwlLove."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">fwlLove</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../compass/">Compass</a></li><li><a class="tocitem" href="../tutorials/">Tutorials</a><ul><li><a class="tocitem" href="../tutorials/ch1/">chapter 1 - Loading Data</a></li><li><a class="tocitem" href="../tutorials/ch2/">chapter 2 - Running Model</a></li><li><a class="tocitem" href="../tutorials/ch3/">chapter 3 - Plotting</a></li></ul></li><li><a class="tocitem" href="../how-to-guides/">How-to guides</a></li><li><a class="tocitem" href="../reference/">Reference</a><ul><li><a class="tocitem" href="../reference/ch1/">chapter 1 - Rheology</a></li><li><a class="tocitem" href="../reference/ch2/">chapter 2 - Solid-phase</a></li><li><a class="tocitem" href="../reference/ch3/">chapter 3 - Mush layer</a></li><li><a class="tocitem" href="../reference/ch4/">chapter 4 - Liquid-phase</a></li><li><a class="tocitem" href="../reference/ch5/">chapter 5 - Forcing Frequency</a></li><li><a class="tocitem" href="../reference/ch6/">chapter 6 - Surface Loading</a></li><li><a class="tocitem" href="../reference/ch7/">chapter 7 - Tidal Potentials</a></li></ul></li><li><a class="tocitem" href="../explanation/">Explanation</a></li><li><a class="tocitem" href="../troubleshooting/">Troubleshooting</a></li><li class="is-active"><a class="tocitem" href>Development</a><ul class="internal"><li><a class="tocitem" href="#Contributing"><span>Contributing</span></a></li><li><a class="tocitem" href="#Coding-style"><span>Coding style</span></a></li><li><a class="tocitem" href="#Code-reference"><span>Code reference</span></a></li></ul></li><li><a class="tocitem" href="../ecosystem/">Related codes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Development</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Development</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FormingWorlds/Love.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FormingWorlds/Love.jl/blob/main/docs/src/development.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Development-manual"><a class="docs-heading-anchor" href="#Development-manual">Development manual</a><a id="Development-manual-1"></a><a class="docs-heading-anchor-permalink" href="#Development-manual" title="Permalink"></a></h1><h2 id="Contributing"><a class="docs-heading-anchor" href="#Contributing">Contributing</a><a id="Contributing-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing" title="Permalink"></a></h2><p>If you are interested in contributing to the model, please contact the developers using the information on the Home page.</p><h2 id="Coding-style"><a class="docs-heading-anchor" href="#Coding-style">Coding style</a><a id="Coding-style-1"></a><a class="docs-heading-anchor-permalink" href="#Coding-style" title="Permalink"></a></h2><ul><li>Indentation uses 4 spaces, no tabs.</li><li>Function names should be lowercase, with words separated by underscores .</li><li>Lines should aim to have a length of no more than 92 characters.</li><li>All functions should have docstrings, ideally with Arguments and Returns listed.</li><li>More comments are always better, even if they seem redundant.</li><li>Use type hinting where possible.</li><li>Print statements should be made through the logger where possible.</li></ul><h2 id="Code-reference"><a class="docs-heading-anchor" href="#Code-reference">Code reference</a><a id="Code-reference-1"></a><a class="docs-heading-anchor-permalink" href="#Code-reference" title="Permalink"></a></h2><article><details class="docstring"><summary id="fwlLove.Love.andrade_mu_complex-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#fwlLove.Love.andrade_mu_complex-Tuple{Any, Any, Any}"><code>fwlLove.Love.andrade_mu_complex</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">andrade_mu_complex(ω, μ, η, α)</code></pre><p>Return the complex shear modulus μ̃(ω) for Andrade rheology, using Eq 82b from Efroimsky, M. 2012. μ, η, τA can be scalar or arrays.</p><p>Note: see Efroimsky, M. 2012, Section 5.3 for detailed description.  Note: J is the unrelaxed compliance which is inverse to the unrelaxed rigidity μ,     The same is through in the frequency domain (i.e. with ar{J} = 1/ar{μ}) Appendix B1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L331-L340">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_darcy_displacement!-NTuple{10, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_darcy_displacement!-NTuple{10, Any}"><code>fwlLove.Love.compute_darcy_displacement!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_darcy_displacement!(dis_rel, y, m, r, ω, ϕ, ηl, k, g, ρl)

Calculate the Darcy displacement vector at a particular radial level.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1764-L1768">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_displacement!-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_displacement!-Tuple{Any, Any, Any}"><code>fwlLove.Love.compute_displacement!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_displacement!(dis, y, m)

Calculate the solid displacement vector at a particular radial level.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1744-L1748">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_pore_pressure!-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_pore_pressure!-Tuple{Any, Any, Any}"><code>fwlLove.Love.compute_pore_pressure!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_pore_pressure!(p, y, m)

Calculate the fluid pore pressur at a particular radial level.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1787-L1791">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_strain_ten!-NTuple{16, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_strain_ten!-NTuple{16, Any}"><code>fwlLove.Love.compute_strain_ten!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_strain_ten!(ϵ, y, m, rr, ρr, gr, μr, Ksr, ω, ρlr, Klr, Kdr, αr, ηlr, ϕr, kr)

Calculate the strain tensor ϵ at a particular radial level.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1621-L1625">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_strain_ten!-NTuple{8, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_strain_ten!-NTuple{8, Any}"><code>fwlLove.Love.compute_strain_ten!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_strain_ten!(ϵ, y, m, rr, ρr, gr, μr, Ksr, ω, ρlr, Klr, Kdr, αr, ηlr, ϕr, kr)

Calculate the strain tensor ϵ at a particular radial level.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1683-L1687">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_stress_ten!-NTuple{17, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_stress_ten!-NTuple{17, Any}"><code>fwlLove.Love.compute_stress_ten!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_stress_ten!(σ, ϵ, y, m, rr, ρr, gr, μr, Ksr, ω, ρlr, Klr, Kdr, αr, ηlr, ϕr, kr)

Calculate the stress tensor σ at a particular radial level.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1654-L1658">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_stress_ten!-NTuple{9, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_stress_ten!-NTuple{9, Any}"><code>fwlLove.Love.compute_stress_ten!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_stress_ten!(σ, ϵ, y, m, rr, ρr, gr, μr, Ksr, ω, ρlr, Klr, Kdr, αr, ηlr, ϕr, kr)

Calculate the stress tensor σ at a particular radial level.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1715-L1719">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_y-NTuple{13, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_y-NTuple{13, Any}"><code>fwlLove.Love.compute_y</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">   compute_y(r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k, core=&quot;liquid&quot;)</code></pre><p>Compute the two-phase tidal solution y with the propagator matrix method. </p><p>Returns <code>y</code>, an array with size (8, <code>nr</code>, <code>nlay</code>), where <code>nr</code> is the    number of secondary layers, and <code>nlay</code> is the number of primary layers,     e.g., core, mantle, crust. The first index corresponds to y1 to y8, where</p><p>y1 = radial displacement <br/>   y2 = tangential displacement <br/>   y3 = radial stress <br/>   y4 = tangential stress <br/>   y5 = gravitational potential <br/>   y6 = potential stress <br/>   y7 = pore pressure <br/>   y8 = radial Darcy displacement <br/></p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">   # Define four layer body
   ρs = [7640, 3300, 3300, 3000.]  # Solid density
   μ =  [60, 60, 60, 60] .* 1e9    # Shear modulus
   κs = [100, 200, 200, 200].*1e9  # Solid bulk modulus
   η =  [1e25, 1e25, 1e14, 1e25]   # Shear viscosity
   ζ =  [1e25, 1e25, 1e15, 1e25]   # Compaction viscosity

   ρl = [0, 0, 3300, 0]            # Liquid density
   κl = [0, 0, 1e9, 0]             # Liquid bulk modulus
   κd = 0.01κs                     # Drained compaction modulus
   k =  [0, 0, 1e-7, 0]            # Permeability
   α =  1.0 .- κd ./ κs            # Biot&#39;s modulus
   ηl = [0, 0, 1.0, 0]             # Liquid viscosity
   ϕ =  [0, 0, 0.1, 0]             # Porosity

   ρ = (1 .- ϕ) .* ρs + ϕ .* ρl    # Bulk density

   # Discretize primary layers into 100 secondary layers
   rr = expand_layers(r, nr=100)   
   g = get_g(rr, ρ);               # get gravity profile 

   y1 = compute_y(rr, ρ, g, μ, κs, ω, ρl, κl, κd, α, ηl, ϕ, k);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L854-L895">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.compute_y-NTuple{5, Any}"><a class="docstring-binding" href="#fwlLove.Love.compute_y-NTuple{5, Any}"><code>fwlLove.Love.compute_y</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_y(r, ρ, g, μ, K; core=&quot;liquid&quot;)</code></pre><p>Compute the single-phase tidal solution y with the propagator matrix method. </p><p>Returns <code>y</code>, an array with size (6, <code>nr</code>, <code>nlay</code>), where <code>nr</code> is the number of secondary layers, and <code>nlay</code> is the number of primary layers,  e.g., core, mantle, crust. The first index corresponds to y1 to y6, where</p><p>y1 = radial displacement <br/>y2 = tangential displacement <br/>y3 = radial stress <br/>y4 = tangential stress <br/>y5 = gravitational potential <br/>y6 = potential stress <br/></p><p><strong>Example</strong></p><pre><code class="nohighlight hljs"># Define four layer body
ρs = [7640, 3300, 3300, 3000.]  # Solid density
μ =  [60, 60, 60, 60] .* 1e9    # Shear modulus
κs = [100, 200, 200, 200].*1e9  # Solid bulk modulus

# Discretize primary layers into 100 secondary layers
rr = expand_layers(r, nr=100)   
g = get_g(rr, ρs);               # get gravity profile 

y1 = compute_y(rr, ρ, g, μ, κs);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L965-L992">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.convert_params_to_prec-NTuple{13, Any}"><a class="docstring-binding" href="#fwlLove.Love.convert_params_to_prec-NTuple{13, Any}"><code>fwlLove.Love.convert_params_to_prec</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Convert input parameters into the required precision.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L824">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.convert_params_to_prec-NTuple{5, Any}"><a class="docstring-binding" href="#fwlLove.Love.convert_params_to_prec-NTuple{5, Any}"><code>fwlLove.Love.convert_params_to_prec</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Convert input parameters into the required precision.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L843">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.define_spherical_grid-Tuple{Any}"><a class="docstring-binding" href="#fwlLove.Love.define_spherical_grid-Tuple{Any}"><code>fwlLove.Love.define_spherical_grid</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">define_spherical_grid(res)</code></pre><p>Create the spherical grid of angular resolution <code>res</code> in degrees. This is used for  numerical integrations over solid angle. A new grid can easily be defined by  recalling the function with a new <code>res</code>.</p><p>The grid is internal to Love, but can be accessed with </p><pre><code class="nohighlight hljs">Love.clats[:] # colatitude grid
Love.lons[:]  # longitude grid</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1566-L1577">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.expand_layers-Tuple{Any}"><a class="docstring-binding" href="#fwlLove.Love.expand_layers-Tuple{Any}"><code>fwlLove.Love.expand_layers</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">expand_layers(r; nr::Int=80)</code></pre><p>Discretize the primary layers given by <code>r</code> into <code>nr</code> discrete secondary layers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1071-L1076">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.find_mush_index-Tuple{Any}"><a class="docstring-binding" href="#fwlLove.Love.find_mush_index-Tuple{Any}"><code>fwlLove.Love.find_mush_index</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">find_mush_index(ϕ)</code></pre><p>Find the mush region using ϕ (melt fraction) profile.:</p><ol><li>Identify all indices where ϕ ≠ 0.</li><li>Partition these into connected segments.</li><li>Pick the connected segment with the smallest starting index</li></ol><p>(the shallowest mush layer).</p><ol><li>Return the <em>largest</em> index in that segment (bottom of mush).</li></ol><p>Returns <code>nothing</code> if ϕ is zero everywhere.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L288-L300">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_A!-Tuple{Matrix, Vararg{Any, 13}}"><a class="docstring-binding" href="#fwlLove.Love.get_A!-Tuple{Matrix, Vararg{Any, 13}}"><code>fwlLove.Love.get_A!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_A!(A::Matrix, r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)</code></pre><p>Compute the 8x8 <code>A</code> matrix in the ODE for the two-phase problem. These correspond to  the coefficients given in Equation S4.6 in Hay et al., (2025).</p><p>See also <a href="#fwlLove.Love.get_A-NTuple{13, Any}"><code>get_A</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L460-L467">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_A!-Tuple{Matrix, Vararg{Any, 5}}"><a class="docstring-binding" href="#fwlLove.Love.get_A!-Tuple{Matrix, Vararg{Any, 5}}"><code>fwlLove.Love.get_A!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_A!(r, ρ, g, μ, K; λ=nothing)</code></pre><p>Compute the 6x6 <code>A</code> matrix in the ODE for the solid-body problem. These correspond to  the coefficients given in Equation S4.6 in Hay et al., (2025) when α=φ=0, as well as Sabadini and Vermeersen  (2016) Eq. 1.95.</p><p>See also <a href="#fwlLove.Love.get_A-NTuple{13, Any}"><code>get_A</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L398-L406">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_A-NTuple{13, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_A-NTuple{13, Any}"><code>fwlLove.Love.get_A</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_A(A::Matrix, r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)</code></pre><p>Compute the 8x8 <code>A</code> matrix in the ODE for the two-phase problem. These correspond to  the coefficients given in Equation S4.6 in Hay et al., (2025).</p><p>See also <a href="#fwlLove.Love.get_A!-Tuple{Matrix, Vararg{Any, 13}}"><code>get_A!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L446-L453">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_A-NTuple{5, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_A-NTuple{5, Any}"><code>fwlLove.Love.get_A</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_A(r, ρ, g, μ, K)</code></pre><p>Compute the 6x6 <code>A</code> matrix in the ODE for the solid-body problem.</p><p>See also <a href="#fwlLove.Love.get_A!-Tuple{Matrix, Vararg{Any, 13}}"><code>get_A!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L385-L391">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_B!-NTuple{16, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_B!-NTuple{16, Any}"><code>fwlLove.Love.get_B!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_B!(B, r1, r2, g1, g2, ρ, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)</code></pre><p>Compute the 8x8 numerical integrator matrix, which integrates dy/dr from <code>r1</code> to <code>r2</code> for the two-phase problem.</p><p><code>B</code> here represnts the RK4 integrator, given by Eq. S5.5 in Hay et al., (2025).</p><p>See also <a href="#fwlLove.Love.get_B-NTuple{15, Any}"><code>get_B</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L522-L530">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_B!-NTuple{8, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_B!-NTuple{8, Any}"><code>fwlLove.Love.get_B!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_B!(B, r1, r2, g1, g2, ρ, μ, K)</code></pre><p>Compute the 6x6 numerical integrator matrix, which integrates dy/dr from <code>r1</code> to <code>r2</code> for the solid-body problem.</p><p><code>B</code> here represnts the RK4 integrator, given by Eq. S5.5 in Hay et al., (2025).</p><p>See also <a href="#fwlLove.Love.get_B-NTuple{15, Any}"><code>get_B</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L556-L564">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_B-NTuple{15, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_B-NTuple{15, Any}"><code>fwlLove.Love.get_B</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>See &#39;get_B!&#39; for definition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L514">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_B-NTuple{7, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_B-NTuple{7, Any}"><code>fwlLove.Love.get_B</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>See &#39;get_B!&#39; for definition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L549">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_B_product!-NTuple{14, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_B_product!-NTuple{14, Any}"><code>fwlLove.Love.get_B_product!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_B_product!(Brod, r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)</code></pre><p>Compute the product of the 8x8 B matrices within a primary layer. This is used to propgate the y solution across a single two-phase primary layer.</p><p>Bprod is denoted by D in Eq. S5.14 in Hay et al., (2025).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L584-L591">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_B_product!-NTuple{6, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_B_product!-NTuple{6, Any}"><code>fwlLove.Love.get_B_product!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_B_product!(Brod, r, ρ, g, μ, K)</code></pre><p>Compute the product of the 6x6 B matrices within a primary layer. This is used to propgate the y solution across one single-phase (solid) primary layer.</p><p>Bprod is denoted by D in Eq. S5.14 in Hay et al., (2025).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L630-L637">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_Ic-NTuple{5, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_Ic-NTuple{5, Any}"><code>fwlLove.Love.get_Ic</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Get the core solution vector</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1034">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_g-Tuple{Any, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_g-Tuple{Any, Any}"><code>fwlLove.Love.get_g</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_g(r, ρ)</code></pre><p>Compute the radial gravity structure associated with a density profile <code>r</code> at intervals given by <code>r</code>.</p><p><code>r</code> must be be a 2D array, with index 1 representing the top radius of secondary layers, and index 2 representing the top radius of primary layers. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L363-L370">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_heating_map-NTuple{15, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_heating_map-NTuple{15, Any}"><code>fwlLove.Love.get_heating_map</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">function get_heating_map(y, r, ρ, g, μ, Ks, ω, ρl, Kl, Kd, α, ηl, ϕ, k, ecc; vol=false)</code></pre><p>Get a surface heating map for two-phase tides and eccentricity forcing, assuming synchronous rotation. Heating rate is computed with numerical integration using the solution  <code>y</code> returned by <a href="#fwlLove.Love.compute_y-NTuple{13, Any}"><code>compute_y</code></a>,  using Eq. 2.39a/b/c integrated in radius.  The forcing magnitude is determined by orbital frequency <code>ω</code> and eccentricity <code>ecc</code>. </p><p>Returns the radially integrated heating maps in W/m^2 for dissipation due to shear,  compaction, and Darcy flow. If <code>vol=true</code>, then additional volumentric heating arrays  will also be returned in W/m^3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1194-L1207">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_heating_map-NTuple{8, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_heating_map-NTuple{8, Any}"><code>fwlLove.Love.get_heating_map</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_heating_map(y, r, ρ, g, μ, κ, ω, ecc; vol=false)</code></pre><p>Get a surface heating map for solid-body tides and eccentricity forcing, assuming synchronous rotation. Heating rate is computed  with numerical integration using the solution <code>y</code> returned by <a href="#fwlLove.Love.compute_y-NTuple{13, Any}"><code>compute_y</code></a>,  using Eq. 2.39a/b integrated in radius.  The forcing magnitude is determined by orbital frequency <code>ω</code> and eccentricity <code>ecc</code>. </p><p>Returns the radially integrated heating maps in W/m^2 for dissipation due to shear  and compaction. If <code>vol=true</code>, then additional volumentric heating arrays  will also be returned in W/m^3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1104-L1116">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_heating_profile-NTuple{15, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_heating_profile-NTuple{15, Any}"><code>fwlLove.Love.get_heating_profile</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_heating_profile(y, r, ρ, g, μ, Ks, ω, ρl, Kl, Kd, α, ηl, ϕ, k, ecc; lay=nothing)</code></pre><p>Get the radial volumetric heating for two-phase tides and eccentricity forcing, assuming synchronous rotation. Heating rate is computed with numerical integration using the solution  <code>y</code> returned by <a href="#fwlLove.Love.compute_y-NTuple{13, Any}"><code>compute_y</code></a>,  using Eq. 2.39a/b/c integrated over solid angle.  The forcing magnitude is determined by orbital frequency <code>ω</code> and eccentricity <code>ecc</code>.  The heating profile for a specific layer is specified with <code>lay</code>, otherwise all  layers will be caclulated.</p><p>Returns the angular averaged volumetric heating profiles in W/m^3 for dissipation due to shear,  compaction and Darcy flow, as well as the total power dissipated in each primary layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1421-L1435">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_heating_profile-NTuple{8, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_heating_profile-NTuple{8, Any}"><code>fwlLove.Love.get_heating_profile</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">function get_heating_profile(y, r, ρ, g, μ, κ, ω, ecc; lay=nothing)</code></pre><p>Get the radial volumetric heating for solid-body tides and eccentricity forcing, assuming synchronous rotation. Heating rate is computed with numerical integration using the solution  <code>y</code> returned by <a href="#fwlLove.Love.compute_y-NTuple{13, Any}"><code>compute_y</code></a>,  using Eq. 2.39a/b integrated over solid angle.  The forcing magnitude is determined by orbital frequency <code>ω</code> and eccentricity <code>ecc</code>.  The heating profile for a specific layer is specified with <code>lay</code>, otherwise all  layers will be caclulated.</p><p>Returns the angular averaged volumetric heating profiles in W/m^3 for dissipation due to shear  and compaction, as well as the power dissipated in each primary layer in W/m^3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1320-L1334">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_solution-NTuple{10, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_solution-NTuple{10, Any}"><code>fwlLove.Love.get_solution</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_solution(y, n, m, r, ρ, g, μ, K, ω)</code></pre><p>Expand the tidal solution from y at degree <code>n</code> and order <code>m</code>. </p><p><strong>Prerequisite calls</strong></p><p>Note that <a href="#fwlLove.Love.define_spherical_grid-Tuple{Any}"><code>define_spherical_grid()</code></a> must be called first.</p><p><strong>Returns</strong></p><p>A tuple of the complex fourier coefficients on a lat-lon grid for </p><ol><li>displacement, u </li><li>solid strain, εs </li><li>total stress, σ </li></ol><p>For tensors, the array dimensions represent (nlat, nlon, 6xtensor components, secondary lay., primary lay.) For vectors, the array dimensions represent (nlat, nlon, 3xvector components, secondary lay., primary lay.) For scalars, the array dimensions represent (nlat, nlon, secondary lay., primary lay.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L762-L781">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_solution-NTuple{16, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_solution-NTuple{16, Any}"><code>fwlLove.Love.get_solution</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_solution(y, n, m, r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)</code></pre><p>Expand the tidal solution from y at degree <code>n</code> and order <code>m</code>. </p><p><strong>Prerequisite calls</strong></p><p>Note that <a href="#fwlLove.Love.define_spherical_grid-Tuple{Any}"><code>define_spherical_grid()</code></a> must be called first.</p><p><strong>Returns</strong></p><p>A tuple of the complex fourier coefficients on a lat-lon grid for </p><ol><li>displacement, u </li><li>solid strain, εs </li><li>total stress, σ </li><li>pore pressure, pl </li><li>darcy (relative) displacement, u_rel</li></ol><p>For tensors, the array dimensions represent (nlat, nlon, 6xtensor components, secondary lay., primary lay.) For vectors, the array dimensions represent (nlat, nlon, 3xvector components, secondary lay., primary lay.) For scalars, the array dimensions represent (nlat, nlon, secondary lay., primary lay.)</p><p>To recover the real solution at time t, the forcing magnitude and direction must be known. </p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">sol_22 = get_solution(y1, 2, 2, rr, ρ, g, μ, κs, ω, ρl, κl, κd, α, ηl, ϕ, k);
sol_20  = get_solution(y1, 2,  0, rr, ρ, g, μ, κs, ω, ρl, κl, κd, α, ηl, ϕ, k);

# eccentricity forcing 
U22E =  7/8 * ω^2*R^2*ecc 
U22W = -1/8 * ω^2*R^2*ecc 
U20  = -3/2 * ω^2*R^2*ecc 

Y = Love.clats;
X = Love.lons;
P20 = 0.5 .* (3 .* cos.(Y).^2 .- 1)
P22 = 3 .* (1. .- cos.(Y).^2)

# define phase of solution (0 to 2pi)
ωt = 0.0

# Obtain the radial tide
# Combine the solutions - note that the west component is a complex conjugate
tide = (U22E*sol_22[1] + U20*sol_20[1])[:,:,1,end,end] 
        .+ U22W*conj.(sol_22[1])[:,:,1,end,end];
tide = 0.5real.(tide .* exp(-1im * ωt) .+ conj.(tide) .* exp(1im * ωt));</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L661-L710">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.get_total_heating-NTuple{4, Any}"><a class="docstring-binding" href="#fwlLove.Love.get_total_heating-NTuple{4, Any}"><code>fwlLove.Love.get_total_heating</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_total_heating(y, ω, R, ecc)</code></pre><p>Get the total heating rate for solution <code>y</code> due to orbital eccentricity <code>e</code>  for a body with synchronous rotation rate <code>ω</code> and radius <code>R</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L1090-L1096">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Love.set_G-Tuple{Any}"><a class="docstring-binding" href="#fwlLove.Love.set_G-Tuple{Any}"><code>fwlLove.Love.set_G</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">set_G(new_G)</code></pre><p>Overwrite the value of the Universal Gravitational Constant. Only to be used for non-dimensional calculations!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Love.jl#L350-L354">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Fluid.calc_fluid_tides-Tuple{BigFloat, BigFloat, BigFloat, BigFloat, BigFloat, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}}"><a class="docstring-binding" href="#fwlLove.Fluid.calc_fluid_tides-Tuple{BigFloat, BigFloat, BigFloat, BigFloat, BigFloat, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}}"><code>fwlLove.Fluid.calc_fluid_tides</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">calc_fluid_tides(omega, axial, ecc, sma, S_mass, rho, radius, visc; 
                N_sigma=301, visc_l=5e2, visc_s=5e21, sigma_R=1e-3)</code></pre><p>Calculate the tidal heating in the fluid layers of a planetary interior.</p><p>This function computes the tidal dissipation power profile and the total tidal heating  for liquid layers using Love numbers, Hansen coefficients, and a viscoelastic  approximation for the solid interior. It also returns the k2 Love number at the  forcing frequency used by the calculation.</p><p><strong>Arguments</strong></p><ul><li><code>omega::prec</code> : Orbital frequency of the planet [rad/s].</li><li><code>axial::prec</code> : Axial rotation frequency of the planet [rad/s].</li><li><code>ecc::prec</code>   : Orbital eccentricity.</li><li><code>sma::prec</code>   : Semi-major axis of the orbit [m].</li><li><code>S_mass::prec</code> : Stellar mass [kg].</li><li><code>rho::Array{prec,1}</code> : Layered density profile [kg/m³].</li><li><code>radius::Array{prec,1}</code> : Layer boundaries [m], length = number of layers + 1.</li><li><code>visc::Array{prec,1}</code> : Layer viscosities [Pa·s].</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>N_sigma::Int=301</code> : Number of frequency bins for spectral calculations.</li><li><code>visc_l::Float64=5e2</code> : Threshold viscosity below which a layer is considered liquid [Pa·s].</li><li><code>visc_s::Float64=5e21</code> : Threshold viscosity above which a layer is considered solid [Pa·s].</li><li><code>sigma_R::Float64=1e-3</code> : Rayleigh drag coefficient for the fluid interface [1/s].</li></ul><p><strong>Returns</strong></p><p>A tuple with three elements:</p><ol><li><code>power_prf::Vector{Float64}</code> : Tidal heating power profile for each layer [W].</li><li><code>P_tidal_total::Float64</code> : Total tidal dissipation power in the fluid layers [W].</li><li><code>k2_total::Float64</code> : Complex k2 Love number at the forcing frequency.</li></ol><p><strong>Errors</strong></p><p>Throws an error if:</p><ul><li>No liquid layers are found in the interior (<code>ρ_l</code> empty), suggesting that <code>visc_l</code> needs adjustment.</li><li>The interior structure is incompatible with computing mean densities.</li></ul><p><strong>Notes</strong></p><ul><li>Layers are categorized into liquid, mush, and solid based on <code>visc_l</code> and <code>visc_s</code>.</li><li><code>r_b</code> denotes the bottom of the liquid region.</li><li>Hansen coefficients and Love numbers are computed over a frequency spectrum and interpolated.</li><li>The total tidal dissipation is computed using both the fluid and solid contributions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Fluid.jl#L29-L74">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Fluid.Hansen.get_hansen-Tuple{Any, Vararg{Int64, 4}}"><a class="docstring-binding" href="#fwlLove.Fluid.Hansen.get_hansen-Tuple{Any, Vararg{Int64, 4}}"><code>fwlLove.Fluid.Hansen.get_hansen</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_hansen(ecc)</code></pre><p>Wrapper used in your original code: computes Hansen coefficients for given eccentricity. Relies on global n, m, k<em>min, k</em>max.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Hansen.jl#L15-L21">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Fluid.Hansen.hansen_fft-NTuple{5, Any}"><a class="docstring-binding" href="#fwlLove.Fluid.Hansen.hansen_fft-NTuple{5, Any}"><code>fwlLove.Fluid.Hansen.hansen_fft</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hansen_fft(n, m, e, kmin, kmax; N=nothing)</code></pre><p>Compute Hansen coefficients X_k^{n,m}(e) using FFT on mean anomaly.</p><p>Returns a tuple (k, Xkm), where:</p><ul><li>k is a vector of integer k-indices</li><li>Xkm are the corresponding Hansen coefficients (real part)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Hansen.jl#L67-L75">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Fluid.Hansen.kepler_newton-Tuple{Any, Any}"><a class="docstring-binding" href="#fwlLove.Fluid.Hansen.kepler_newton-Tuple{Any, Any}"><code>fwlLove.Fluid.Hansen.kepler_newton</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">kepler_newton(M, e)</code></pre><p>Solve Kepler’s equation  E - e*sin(E) = M for the eccentric anomaly E, using Newton iteration. M may be scalar or array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Hansen.jl#L37-L43">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.Fluid.Hansen.nextpow2_int-Tuple{Int64}"><a class="docstring-binding" href="#fwlLove.Fluid.Hansen.nextpow2_int-Tuple{Int64}"><code>fwlLove.Fluid.Hansen.nextpow2_int</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">nextpow2_int(x)</code></pre><p>Return the integer p such that 2^p ≥ x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/81ebb06a6c6e9836d92bd67f28baf6e90a901558/src/Hansen.jl#L27-L31">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../troubleshooting/">« Troubleshooting</a><a class="docs-footer-nextpage" href="../ecosystem/">Related codes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 14 December 2025 20:45">Sunday 14 December 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
