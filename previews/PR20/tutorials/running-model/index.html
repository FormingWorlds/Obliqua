<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2 - Running Model · fwlLove</title><meta name="title" content="2 - Running Model · fwlLove"/><meta property="og:title" content="2 - Running Model · fwlLove"/><meta property="twitter:title" content="2 - Running Model · fwlLove"/><meta name="description" content="Documentation for fwlLove."/><meta property="og:description" content="Documentation for fwlLove."/><meta property="twitter:description" content="Documentation for fwlLove."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">fwlLove</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../compass/">Compass</a></li><li><a class="tocitem" href="../">Tutorials</a><ul><li><a class="tocitem" href="../loading-data/">1 - Loading Data</a></li><li class="is-active"><a class="tocitem" href>2 - Running Model</a></li><li><a class="tocitem" href="../plotting/">3 - Plotting</a></li></ul></li><li><a class="tocitem" href="../../how-to-guides/">How-to guides</a></li><li><a class="tocitem" href="../../reference/">Reference</a><ul><li><a class="tocitem" href="../../reference/rheology/">1 - Rheology</a></li><li><a class="tocitem" href="../../reference/solid-phase/">2 - Solid-phase</a></li><li><a class="tocitem" href="../../reference/mush-layer/">3 - Mush layer</a></li><li><a class="tocitem" href="../../reference/liquid-phase/">4 - Liquid-phase</a></li><li><a class="tocitem" href="../../reference/forcing-frequency/">5 - Forcing Frequency</a></li><li><a class="tocitem" href="../../reference/surface-loading/">6 - Surface Loading</a></li><li><a class="tocitem" href="../../reference/tidal-potentials/">7 - Tidal Potentials</a></li></ul></li><li><a class="tocitem" href="../../explanation/">Explanation</a></li><li><a class="tocitem" href="../../troubleshooting/">Troubleshooting</a></li><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../ecosystem/">Related codes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a href="../">Tutorials</a></li><li class="is-active"><a href>2 - Running Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2 - Running Model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FormingWorlds/Love.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FormingWorlds/Love.jl/blob/main/docs/src/tutorials/running-model.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h3 id="Tutorials-(2)"><a class="docs-heading-anchor" href="#Tutorials-(2)">Tutorials (2)</a><a id="Tutorials-(2)-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorials-(2)" title="Permalink"></a></h3><h1 id="Running-Model"><a class="docs-heading-anchor" href="#Running-Model">Running Model</a><a id="Running-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Running-Model" title="Permalink"></a></h1><p>Now that you are able to validate and load data files using the <code>fwlLove.load</code> module, we can start using the tidal models <code>fwlLove.Love</code> and <code>fwlLove.Fluid</code>. In principle, this is rather simple, since you only have to call one function depending on your use case. For example, let us proceed with the data file from <a href="../loading-data/#Loading-data">Loading data</a>. In this case, following the <a href="../loading-data/#Table-of-inputs">Table of inputs</a>, we are interested in the solid-phase tides, so we should use <code>fwlLove.Love.calc_lovepy_tides</code>.</p><pre><code class="language-julia hljs">using fwlLove

# location of data files
RES_DIR = &quot;/path/to/fwlLove/res&quot;

# use the relevant load function
omega, ecc, rho, radius, visc, shear, bulk, ncalc = load.load_interior(&quot;$RES_DIR/interior_data/test_mantle.json&quot;, false)

# call the desired model
power_prf, power_blk, imag_k2 = Love.calc_lovepy_tides(omega, ecc, rho, radius, visc, shear, bulk; ncalc=ncalc, material=&quot;maxwell&quot;)
</code></pre><p>In general, we can use </p><table><tr><th style="text-align: left">Tides</th><th style="text-align: left">Function</th></tr><tr><td style="text-align: left">solid-phase</td><td style="text-align: left"><code>fwlLove.calc_lovepy_tides</code></td></tr><tr><td style="text-align: left">solid-phase + mush layer</td><td style="text-align: left"><code>fwlLove.calc_lovepy_tides_mush</code></td></tr><tr><td style="text-align: left">liquid-phase</td><td style="text-align: left"><code>fwlLove.calc_fluid_tides</code></td></tr><tr><td style="text-align: left">solid+liquid-phase</td><td style="text-align: left"><code>fwlLove.run_tides</code></td></tr></table><hr/><hr/><article><details class="docstring"><summary id="fwlLove.calc_fluid_tides-Tuple{BigFloat, BigFloat, BigFloat, BigFloat, BigFloat, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}}"><a class="docstring-binding" href="#fwlLove.calc_fluid_tides-Tuple{BigFloat, BigFloat, BigFloat, BigFloat, BigFloat, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}}"><code>fwlLove.calc_fluid_tides</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">calc_fluid_tides(omega, axial, ecc, sma, S_mass, rho, radius, visc; 
                N_sigma=301, visc_l=5e2, visc_s=5e21, sigma_R=1e-3)</code></pre><p>Calculate the tidal heating in the fluid layers of a planetary interior.</p><p>This function computes the tidal dissipation power profile and the total tidal heating  for liquid layers using Love numbers, Hansen coefficients, and a viscoelastic  approximation for the solid interior. It also returns the k2 Love number at the  forcing frequency used by the calculation.</p><p><strong>Arguments</strong></p><ul><li><code>omega::prec</code> : Orbital frequency of the planet [rad/s].</li><li><code>axial::prec</code> : Axial rotation frequency of the planet [rad/s].</li><li><code>ecc::prec</code>   : Orbital eccentricity.</li><li><code>sma::prec</code>   : Semi-major axis of the orbit [m].</li><li><code>S_mass::prec</code> : Stellar mass [kg].</li><li><code>rho::Array{prec,1}</code> : Layered density profile [kg/m³].</li><li><code>radius::Array{prec,1}</code> : Layer boundaries [m], length = number of layers + 1.</li><li><code>visc::Array{prec,1}</code> : Layer viscosities [Pa·s].</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>N_sigma::Int=301</code> : Number of frequency bins for spectral calculations.</li><li><code>visc_l::Float64=5e2</code> : Threshold viscosity below which a layer is considered liquid [Pa·s].</li><li><code>visc_s::Float64=5e21</code> : Threshold viscosity above which a layer is considered solid [Pa·s].</li><li><code>sigma_R::Float64=1e-3</code> : Rayleigh drag coefficient for the fluid interface [1/s].</li></ul><p><strong>Returns</strong></p><p>A tuple with three elements:</p><ol><li><code>power_prf::Vector{Float64}</code> : Tidal heating power profile for each layer [W].</li><li><code>P_tidal_total::Float64</code> : Total tidal dissipation power in the fluid layers [W].</li><li><code>k2_total::Float64</code> : Complex k2 Love number at the forcing frequency.</li></ol><p><strong>Errors</strong></p><p>Throws an error if:</p><ul><li>No liquid layers are found in the interior (<code>ρ_l</code> empty), suggesting that <code>visc_l</code> needs adjustment.</li><li>The interior structure is incompatible with computing mean densities.</li></ul><p><strong>Notes</strong></p><ul><li>Layers are categorized into liquid, mush, and solid based on <code>visc_l</code> and <code>visc_s</code>.</li><li><code>r_b</code> denotes the bottom of the liquid region.</li><li>Hansen coefficients and Love numbers are computed over a frequency spectrum and interpolated.</li><li>The total tidal dissipation is computed using both the fluid and solid contributions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/8c35362665d5a852a0bb8afc6d8c2392c20c2f6a/src/fwlLove.jl#L436-L481">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.calc_lovepy_tides-Tuple{BigFloat, BigFloat, Vararg{Vector{BigFloat}, 5}}"><a class="docstring-binding" href="#fwlLove.calc_lovepy_tides-Tuple{BigFloat, BigFloat, Vararg{Vector{BigFloat}, 5}}"><code>fwlLove.calc_lovepy_tides</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">calc_lovepy_tides(omega, ecc, rho, radius, visc, shear, bulk; ncalc=2000, material=&quot;andrade&quot;)</code></pre><p>Calculate tidal heating in a solid planetary interior using the Love number approach (<code>Love.jl</code>).</p><p><strong>Arguments</strong></p><ul><li><code>omega::prec</code> : Forcing angular frequency (rad/s).  </li><li><code>ecc::prec</code> : Orbital eccentricity.  </li><li><code>rho::Vector{prec}</code> : Radial density profile (kg/m³), first element = core.  </li><li><code>radius::Vector{prec}</code> : Radial grid points corresponding to <code>rho</code> (m).  </li><li><code>visc::Vector{prec}</code> : Viscosity profile (Pa·s).  </li><li><code>shear::Vector{prec}</code> : Shear modulus profile (Pa).  </li><li><code>bulk::Vector{prec}</code> : Bulk modulus profile (Pa).  </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>ncalc::Int=2000</code> : Number of subdivisions for radial layers.  </li><li><code>material::String=&quot;andrade&quot;</code> : Rheology model for complex shear modulus. Options: <code>&quot;maxwell&quot;</code>, <code>&quot;andrade&quot;</code>.</li></ul><p><strong>Returns</strong></p><p>A tuple <code>(power_prf, power_blk, k2_im)</code>:</p><ul><li><code>power_prf::Vector{Float64}</code> : Tidal heating profile per unit mass (W/kg).  </li><li><code>power_blk::Float64</code> : Total bulk tidal heating (W).  </li><li><code>k2_im::Float64</code> : Imaginary part of the complex tidal Love number k2 at the forcing frequency.  </li></ul><p><strong>Notes</strong></p><ul><li>Implements Efroimsky (2012) equations for viscoelastic response.  </li><li>Shear and bulk heating contributions are computed separately and summed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/8c35362665d5a852a0bb8afc6d8c2392c20c2f6a/src/fwlLove.jl#L174-L201">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.calc_lovepy_tides_mush-Tuple{BigFloat, BigFloat, Vararg{Vector{BigFloat}, 6}}"><a class="docstring-binding" href="#fwlLove.calc_lovepy_tides_mush-Tuple{BigFloat, BigFloat, Vararg{Vector{BigFloat}, 6}}"><code>fwlLove.calc_lovepy_tides_mush</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">calc_lovepy_tides_mush(omega, ecc, rho, radius, visc, shear, bulk, phi;
                        ncalc=2000, material=&quot;andrade&quot;, visc_l=1e2,
                        bulk_l=1e9, permea=1e-7)</code></pre><p>Calculate tidal heating in a partially molten planetary interior with a mush region.</p><p><strong>Arguments</strong></p><ul><li><code>omega::prec</code> : Forcing angular frequency (rad/s).  </li><li><code>ecc::prec</code> : Orbital eccentricity.  </li><li><code>rho::Vector{prec}</code> : Radial density profile (kg/m³), first element = core.  </li><li><code>radius::Vector{prec}</code> : Radial grid points corresponding to <code>rho</code> (m).  </li><li><code>visc::Vector{prec}</code> : Viscosity profile (Pa·s).  </li><li><code>shear::Vector{prec}</code> : Shear modulus profile (Pa).  </li><li><code>bulk::Vector{prec}</code> : Bulk modulus profile (Pa).  </li><li><code>phi::Vector{prec}</code> : Melt fraction profile (0–1) for each layer.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>ncalc::Int=2000</code> : Number of subdivisions for radial layers.  </li><li><code>material::String=&quot;andrade&quot;</code> : Rheology model for complex shear modulus. Options: <code>&quot;maxwell&quot;</code>, <code>&quot;andrade&quot;</code>.  </li><li><code>visc_l::Float64=1e2</code> : Liquid viscosity in mush region (Pa·s).  </li><li><code>bulk_l::Float64=1e9</code> : Bulk modulus of liquid in mush region (Pa).  </li><li><code>permea::Float64=1e-7</code> : Permeability of mush region (m²).</li></ul><p><strong>Returns</strong></p><p>A tuple <code>(power_prf, power_blk, k2_im)</code>:</p><ul><li><code>power_prf::Vector{Float64}</code> : Tidal heating profile per unit mass (W/kg).  </li><li><code>power_blk::Float64</code> : Total bulk tidal heating (W).  </li><li><code>k2_im::Float64</code> : Imaginary part of the complex tidal Love number k2 at the forcing frequency.  </li></ul><p><strong>Notes</strong></p><ul><li>Accounts for porosity and partial melt (mush) effects on tidal dissipation.  </li><li>Uses drained and Biot moduli to handle fluid–solid coupling.  </li><li>Throws an error if no mush region is identified (<code>phi</code> insufficient).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/8c35362665d5a852a0bb8afc6d8c2392c20c2f6a/src/fwlLove.jl#L283-L317">source</a></section></details></article><article><details class="docstring"><summary id="fwlLove.run_tides-Tuple{BigFloat, BigFloat, BigFloat, BigFloat, BigFloat, Vararg{Vector{BigFloat}, 5}}"><a class="docstring-binding" href="#fwlLove.run_tides-Tuple{BigFloat, BigFloat, BigFloat, BigFloat, BigFloat, Vararg{Vector{BigFloat}, 5}}"><code>fwlLove.run_tides</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">run_tides(omega, axial, ecc, sma, S_mass, rho, radius, visc, shear, bulk; kwargs...)</code></pre><p>Compute the tidal heating profile of a planetary interior considering both <strong>solid</strong> and <strong>liquid/mushy layers</strong>.</p><p><strong>Arguments</strong></p><ul><li><code>omega::prec</code> : Orbital frequency of the body.</li><li><code>axial::prec</code> : Axial (spin) frequency of the body.</li><li><code>ecc::prec</code> : Orbital eccentricity.</li><li><code>sma::prec</code> : Semi-major axis of the orbit.</li><li><code>S_mass::prec</code> : Mass of the central body (e.g., star) inducing tides.</li><li><code>rho::Array{prec,1}</code> : Radial density profile of the planet, from core to surface.</li><li><code>radius::Array{prec,1}</code> : Radial positions of layers, from core to surface.</li><li><code>visc::Array{prec,1}</code> : Viscosity profile of the planet.</li><li><code>shear::Array{prec,1}</code> : Shear modulus profile of the solid layers.</li><li><code>bulk::Array{prec,1}</code> : Bulk modulus profile of the solid layers.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>ncalc::Int64=1000</code> : Number of points for tidal calculation in solid layers.</li><li><code>N_sigma::Int64=301</code> : Number of frequency points for fluid tides.</li><li><code>material::String=&quot;andrade&quot;</code> : Rheology model used for solid tides.</li><li><code>visc_l::Float64=1e2</code> : Lower threshold viscosity for defining liquid regions.</li><li><code>visc_l_tol::Float64=5e2</code> : Tolerance added to <code>visc_l</code>.</li><li><code>visc_s::Float64=1e22</code> : Upper threshold viscosity for defining solid regions.</li><li><code>visc_s_tol::Float64=5e21</code> : Tolerance subtracted from <code>visc_s</code>.</li><li><code>sigma_R::Float64=1e-3</code> : Rayleigh drag coefficient for fluid layers.</li></ul><p><strong>Returns</strong></p><ul><li><code>power_prf::Array{Float64,1}</code> : Radial profile of tidal heating (W/m³).</li><li><code>power_blk::Float64</code> : Total tidal power integrated over the interior (W).</li><li><code>imag_k2::Float64</code> : Imaginary part of the Love number <code>k2</code> for the planet.</li></ul><p><strong>Notes</strong></p><ul><li>The function splits the interior into <strong>solid</strong>, <strong>mush</strong>, and <strong>liquid</strong> regions based on viscosity thresholds.</li><li>Solid tides are computed using <code>calc_lovepy_tides</code>, while fluid/mushy tides are computed using <code>calc_fluid_tides</code>.</li><li>The heating profile is automatically saved as a PDF using <code>save_heat_profile</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FormingWorlds/Love.jl/blob/8c35362665d5a852a0bb8afc6d8c2392c20c2f6a/src/fwlLove.jl#L51-L87">source</a></section></details></article><hr/><hr/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../loading-data/">« 1 - Loading Data</a><a class="docs-footer-nextpage" href="../plotting/">3 - Plotting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 16 December 2025 10:41">Tuesday 16 December 2025</span>. Using Julia version 1.11.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
