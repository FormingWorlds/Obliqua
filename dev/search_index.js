var documenterSearchIndex = {"docs":
[{"location":"tutorials/loading-data/#Tutorials-(1)","page":"1 - Loading Data","title":"Tutorials (1)","text":"","category":"section"},{"location":"tutorials/loading-data/#Loading-data","page":"1 - Loading Data","title":"Loading data","text":"The Obliqua package comes with with several tidal heating modules. Each modules can be excessed through one cohensive function. Depending on which module you want to use Obliqua requires different input parameters. In order to get started, several data files are included, these can be used in combination with the different functions. First we shall show how to load these data files.\n\nThe data files are stored in the /path/to/Obliqua/res folder, and are of type JSON. They have following structure\n\n{\n  \"omega\": \"Float\",\n  \"axial\": \"Float\",\n  \"ecc\": \"Float\",\n  \"sma\": \"Float\",\n  \"S_mass\": \"Float\",\n  \"density\": \"[Array]\",\n  \"radius\": \"[Array]\",\n  \"visc\": \"[Array]\",\n  \"shear\": \"[Array]\",\n  \"bulk\": \"[Array]\",\n  \"phi\": \"[Array]\",\n  \"ncalc\": \"Int\"\n}\n\nDepending on which module is being used the following parameters need to be provided.","category":"section"},{"location":"tutorials/loading-data/#Table-of-inputs","page":"1 - Loading Data","title":"Table of inputs","text":"Input solid-phase solid-phase + mush interface liquid-phase Description Symbol\nomega ✔️ ✔️ ✔️ Orbital Frequency omega\naxial ❌ ❌ ✔️ Axial Frequency Omega\necc ✔️ ✔️ ✔️ Eccentricity epsilon\nsma ❌ ❌ ✔️ Semi major axis a\nS_mass ❌ ❌ ✔️ Stellar mass M_star\ndensity ✔️ ✔️ ✔️ Density profile rho\nradius ✔️ ✔️ ✔️ Radii r\nvisc ✔️ ✔️ ✔️ Viscosity profile eta\nshear ✔️ ✔️ ❌ Shear profile mu\nbulk ✔️ ✔️ ❌ Solid Bulk Modulus kappa_s\nphi ❌ ✔️ ❌ Melt Fraction profile (porosity) phi\nncalc ✔️ ✔️ ❌ Resolution n_textcalc\n\nIt is important to note that the radius array contains the radial values at the boundaries of the spherical shells that make up the planetary mantle, whilst the density, visc, shear, bulk, and phi arrays contain the mean of these in the spherical shells. As such it follows that there are N+1 values in the radius array, and N values in thedensity, visc, shear, bulk, and phi arrays, where N is the number of spherical shells. Please do not confuse ncalc with N, since the former expands the number of layers through interpolation, whereas the latter is the initial resolution of the data. \n\nFor now the user is provided with four different functions, they are given below. The most simple way to use these functions is as follows. First let's test if the provided data is compatible.\n\nusing Obliqua\n\n# location of data files\nRES_DIR = \"/path/to/Obliqua/res\"\n\n# test data validity using included data file\nok = load.load_interior(\"$RES_DIR/interior_data/test_mantle.json\", true)\n\nif ok\n    print(\"Pass\")\nelse\n    print(\"Fail\")\nend\n\n\nNext, let's load the data from the data file.\n\n# use the relevant load function\nomega, ecc, rho, radius, visc, shear, bulk, ncalc = load.load_interior(\"$RES_DIR/interior_data/test_mantle.json\", false)\n\n\n\n\n\n\n\n\n","category":"section"},{"location":"tutorials/loading-data/#Obliqua.load.load_interior","page":"1 - Loading Data","title":"Obliqua.load.load_interior","text":"load_interior(fname::String)\n\nLoad interior structure + tidal parameters from a JSON file.\n\nThe JSON file must contain:\n\n{\n    \"density\": [...],\n    \"radius\": [...],\n    \"visc\": [...],\n    \"shear\": [...],\n    \"bulk\": [...],\n    \"omega\": value,\n    \"ecc\": value,\n    \"ncalc\": value\n}\n\nReturns (if verify=false):\n\n(omega, ecc, rho, radius, visc, shear, bulk, ncalc)\n\n\n\n\n\n","category":"function"},{"location":"tutorials/loading-data/#Obliqua.load.load_interior_full","page":"1 - Loading Data","title":"Obliqua.load.load_interior_full","text":"load_interior_full(fname::String; verify::Bool=false)\n\nLoad the full interior structure and orbital configuration for a body including solid rheology and orbital parameters from a JSON file.\n\nThis is the most complete loader, intended for models that require:\n\nsolid rheology,\norbital forcing,\nstellar properties,\nnumerical resolution control.\n\nThe JSON file must contain:\n\n{\n    \"density\": [...],\n    \"radius\": [...],\n    \"visc\": [...],\n    \"shear\": [...],\n    \"bulk\": [...],\n    \"omega\": value,\n    \"axial\": value,\n    \"ecc\": value,\n    \"sma\": value,\n    \"S_mass\": value,\n    \"ncalc\": value\n}\n\nIf verify=true, the function performs internal consistency and basic physical sanity checks and returns a Bool.\n\nReturns (if verify=false):\n\n(omega, axial, ecc, sma, S_mass, rho, radius, visc, shear, bulk, ncalc)\n\n\n\n\n\n","category":"function"},{"location":"tutorials/loading-data/#Obliqua.load.load_interior_liquid","page":"1 - Loading Data","title":"Obliqua.load.load_interior_liquid","text":"load_interior_liquid(fname::String; verify::Bool=false)\n\nLoad interior structure + orbital parameters for a fully liquid body from a JSON file.\n\nThe JSON file must contain:\n\n{\n    \"density\": [...],\n    \"radius\": [...],\n    \"visc\": [...],\n    \"omega\": value,\n    \"axial\": value,\n    \"ecc\": value,\n    \"sma\": value,\n    \"S_mass\": value\n}\n\nIf verify=true, the function performs basic consistency and physical checks and returns a Bool.\n\nReturns (if verify=false):\n\n(omega, axial, ecc, sma, S_mass, rho, radius, visc)\n\n\n\n\n\n","category":"function"},{"location":"tutorials/loading-data/#Obliqua.load.load_interior_mush","page":"1 - Loading Data","title":"Obliqua.load.load_interior_mush","text":"load_interior_mush(fname::String; verify::Bool=false)\n\nLoad interior structure + tidal parameters for a solid body with a mush layer from a JSON file.\n\nThe JSON file must contain:\n\n{\n    \"density\": [...],\n    \"radius\": [...],\n    \"visc\": [...],\n    \"shear\": [...],\n    \"bulk\": [...],\n    \"phi\": [...],\n    \"omega\": value,\n    \"ecc\": value,\n    \"ncalc\": value\n}\n\nIf verify=true, the function performs basic consistency and physical checks and returns a Bool.\n\nReturns (if verify=false):\n\n(omega, ecc, rho, radius, visc, shear, bulk, phi, ncalc)\n\n\n\n\n\n","category":"function"},{"location":"tutorials/loading-data/#Obliqua.load.load_interior_mush_full","page":"1 - Loading Data","title":"Obliqua.load.load_interior_mush_full","text":"load_interior_mush_full(fname::String; verify::Bool=false)\n\nLoad the full interior structure and orbital configuration for a body including solid rheology and orbital parameters from a JSON file.\n\nThis is the most complete loader, intended for models that require:\n\nsolid rheology,\norbital forcing,\nstellar properties,\nnumerical resolution control.\n\nThe JSON file must contain:\n\n{\n    \"density\": [...],\n    \"radius\": [...],\n    \"visc\": [...],\n    \"shear\": [...],\n    \"bulk\": [...],\n    \"phi\": [...],\n    \"omega\": value,\n    \"axial\": value,\n    \"ecc\": value,\n    \"sma\": value,\n    \"S_mass\": value,\n    \"ncalc\": value\n}\n\nIf verify=true, the function performs internal consistency and basic physical sanity checks and returns a Bool.\n\nReturns (if verify=false):\n\n(omega, axial, ecc, sma, S_mass, rho, radius, visc, shear, bulk, phi, ncalc)\n\n\n\n\n\n","category":"function"},{"location":"reference/liquid-phase/#Reference-(4)","page":"4 - Liquid-phase","title":"Reference (4)","text":"","category":"section"},{"location":"reference/liquid-phase/#Liquid-Phase","page":"4 - Liquid-phase","title":"Liquid-Phase","text":"When the melt fraction of a magma layer exceeds a critical value F_m gtrsim F_mc, its response to tidal forcing becomes fluid-like rather than solid-like. In this regime, tidal deformation is governed by the linearized Laplace tidal equations (LTEs), which describe the dynamics of a thin, global fluid shell of uniform thickness H on a planet of radius R_p.\n\nNeglecting nonlinear advection and mean flows, momentum and mass conservation for the magma ocean read\n\npartial_t vecu + sigma_R vecu + vecf times vecu + g nabla zeta = g nabla zeta_mathrmeq qquad\npartial_t zeta + nabla cdot (H vecu) = 0\n\nwhere vecu is the horizontal velocity, zeta the tidally induced surface displacement, zeta_mathrmeq = U_Tg the equilibrium tide associated with the tidal potential U_T, g the surface gravity, and sigma_R a Rayleigh drag frequency parameterizing dissipation in the magma ocean.\n\nWe focus on the strongly damped, highly viscous limit (sigma_R gg 2Omega), appropriate for magma oceans, in which dissipative processes dominate over rotational effects. In this high-Ekman-number regime, the Coriolis term is negligible and the tidal response becomes overdamped. Dissipation is encapsulated by sigma_R, which should be interpreted as an effective damping rate accounting for viscous resistance, boundary-layer friction, form drag, and porous-flow dissipation near the rheological transition.\n\nTransforming the governing equations to the frequency domain and expanding tidal quantities in spherical harmonics yields a closed-form expression for the complex, frequency-dependent tidal Love number k_ell(sigma). \n\nk_ell(sigma)\n= -fracvarrho_ell barsigma_ell^2sigmatildesigma - barsigma_ell^2\n\nwhere varrho_ell = 3(2n+1)(rho_frho_b) is the degree-ell density ratio between the fluid and the bulk part of the planet. The characteristic frequency is given by\n\nbarsigma_ell = sqrtfracmu_ell g H_mathrmmagmaR^2\n\nwhere H_mathrmmagma the ocean depth, R the radius of the planet, and with \n\nmu_ell = ell(ell+1)\n\nthe eigenvalue of the nth degree spherical harmonic, and \n\ntildesigma = sigma - i sigma_R\n\n","category":"section"},{"location":"development/#Development-manual","page":"Development","title":"Development manual","text":"","category":"section"},{"location":"development/#Contributing","page":"Development","title":"Contributing","text":"If you are interested in contributing to the model, please contact the developers using the information on the Home page.","category":"section"},{"location":"development/#Coding-style","page":"Development","title":"Coding style","text":"Indentation uses 4 spaces, no tabs.\nFunction names should be lowercase, with words separated by underscores .\nLines should aim to have a length of no more than 92 characters.\nAll functions should have docstrings, ideally with Arguments and Returns listed.\nMore comments are always better, even if they seem redundant.\nUse type hinting where possible.\nPrint statements should be made through the logger where possible.","category":"section"},{"location":"development/#Code-reference","page":"Development","title":"Code reference","text":"","category":"section"},{"location":"development/#Obliqua.Love.andrade_mu_complex-Tuple{Any, Any, Any}","page":"Development","title":"Obliqua.Love.andrade_mu_complex","text":"andrade_mu_complex(ω, μ, η, α)\n\nReturn the complex shear modulus μ̃(ω) for Andrade rheology, using Eq 82b from Efroimsky, M. 2012. μ, η, τA can be scalar or arrays.\n\nNote: see Efroimsky, M. 2012, Section 5.3 for detailed description.  Note: J is the unrelaxed compliance which is inverse to the unrelaxed rigidity μ,     The same is through in the frequency domain (i.e. with \bar{J} = 1/\bar{μ}) Appendix B1.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_darcy_displacement!-NTuple{10, Any}","page":"Development","title":"Obliqua.Love.compute_darcy_displacement!","text":"compute_darcy_displacement!(dis_rel, y, m, r, ω, ϕ, ηl, k, g, ρl)\n\nCalculate the Darcy displacement vector at a particular radial level.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_displacement!-Tuple{Any, Any, Any}","page":"Development","title":"Obliqua.Love.compute_displacement!","text":"compute_displacement!(dis, y, m)\n\nCalculate the solid displacement vector at a particular radial level.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_pore_pressure!-Tuple{Any, Any, Any}","page":"Development","title":"Obliqua.Love.compute_pore_pressure!","text":"compute_pore_pressure!(p, y, m)\n\nCalculate the fluid pore pressur at a particular radial level.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_strain_ten!-NTuple{16, Any}","page":"Development","title":"Obliqua.Love.compute_strain_ten!","text":"compute_strain_ten!(ϵ, y, m, rr, ρr, gr, μr, Ksr, ω, ρlr, Klr, Kdr, αr, ηlr, ϕr, kr)\n\nCalculate the strain tensor ϵ at a particular radial level.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_strain_ten!-NTuple{8, Any}","page":"Development","title":"Obliqua.Love.compute_strain_ten!","text":"compute_strain_ten!(ϵ, y, m, rr, ρr, gr, μr, Ksr, ω, ρlr, Klr, Kdr, αr, ηlr, ϕr, kr)\n\nCalculate the strain tensor ϵ at a particular radial level.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_stress_ten!-NTuple{17, Any}","page":"Development","title":"Obliqua.Love.compute_stress_ten!","text":"compute_stress_ten!(σ, ϵ, y, m, rr, ρr, gr, μr, Ksr, ω, ρlr, Klr, Kdr, αr, ηlr, ϕr, kr)\n\nCalculate the stress tensor σ at a particular radial level.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_stress_ten!-NTuple{9, Any}","page":"Development","title":"Obliqua.Love.compute_stress_ten!","text":"compute_stress_ten!(σ, ϵ, y, m, rr, ρr, gr, μr, Ksr, ω, ρlr, Klr, Kdr, αr, ηlr, ϕr, kr)\n\nCalculate the stress tensor σ at a particular radial level.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_y-NTuple{13, Any}","page":"Development","title":"Obliqua.Love.compute_y","text":"   compute_y(r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k, core=\"liquid\")\n\nCompute the two-phase tidal solution y with the propagator matrix method. \n\nReturns y, an array with size (8, nr, nlay), where nr is the    number of secondary layers, and nlay is the number of primary layers,     e.g., core, mantle, crust. The first index corresponds to y1 to y8, where\n\ny1 = radial displacement \n   y2 = tangential displacement \n   y3 = radial stress \n   y4 = tangential stress \n   y5 = gravitational potential \n   y6 = potential stress \n   y7 = pore pressure \n   y8 = radial Darcy displacement \n\n\nExample\n\n   # Define four layer body\n   ρs = [7640, 3300, 3300, 3000.]  # Solid density\n   μ =  [60, 60, 60, 60] .* 1e9    # Shear modulus\n   κs = [100, 200, 200, 200].*1e9  # Solid bulk modulus\n   η =  [1e25, 1e25, 1e14, 1e25]   # Shear viscosity\n   ζ =  [1e25, 1e25, 1e15, 1e25]   # Compaction viscosity\n\n   ρl = [0, 0, 3300, 0]            # Liquid density\n   κl = [0, 0, 1e9, 0]             # Liquid bulk modulus\n   κd = 0.01κs                     # Drained compaction modulus\n   k =  [0, 0, 1e-7, 0]            # Permeability\n   α =  1.0 .- κd ./ κs            # Biot's modulus\n   ηl = [0, 0, 1.0, 0]             # Liquid viscosity\n   ϕ =  [0, 0, 0.1, 0]             # Porosity\n\n   ρ = (1 .- ϕ) .* ρs + ϕ .* ρl    # Bulk density\n\n   # Discretize primary layers into 100 secondary layers\n   rr = expand_layers(r, nr=100)   \n   g = get_g(rr, ρ);               # get gravity profile \n\n   y1 = compute_y(rr, ρ, g, μ, κs, ω, ρl, κl, κd, α, ηl, ϕ, k);\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.compute_y-NTuple{5, Any}","page":"Development","title":"Obliqua.Love.compute_y","text":"compute_y(r, ρ, g, μ, K; core=\"liquid\")\n\nCompute the single-phase tidal solution y with the propagator matrix method. \n\nReturns y, an array with size (6, nr, nlay), where nr is the number of secondary layers, and nlay is the number of primary layers,  e.g., core, mantle, crust. The first index corresponds to y1 to y6, where\n\ny1 = radial displacement \ny2 = tangential displacement \ny3 = radial stress \ny4 = tangential stress \ny5 = gravitational potential \ny6 = potential stress \n\n\nExample\n\n# Define four layer body\nρs = [7640, 3300, 3300, 3000.]  # Solid density\nμ =  [60, 60, 60, 60] .* 1e9    # Shear modulus\nκs = [100, 200, 200, 200].*1e9  # Solid bulk modulus\n\n# Discretize primary layers into 100 secondary layers\nrr = expand_layers(r, nr=100)   \ng = get_g(rr, ρs);               # get gravity profile \n\ny1 = compute_y(rr, ρ, g, μ, κs);\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.convert_params_to_prec-NTuple{13, Any}","page":"Development","title":"Obliqua.Love.convert_params_to_prec","text":"Convert input parameters into the required precision.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.convert_params_to_prec-NTuple{5, Any}","page":"Development","title":"Obliqua.Love.convert_params_to_prec","text":"Convert input parameters into the required precision.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.define_spherical_grid-Tuple{Any}","page":"Development","title":"Obliqua.Love.define_spherical_grid","text":"define_spherical_grid(res)\n\nCreate the spherical grid of angular resolution res in degrees. This is used for  numerical integrations over solid angle. A new grid can easily be defined by  recalling the function with a new res.\n\nThe grid is internal to Love, but can be accessed with \n\nLove.clats[:] # colatitude grid\nLove.lons[:]  # longitude grid\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.expand_layers-Tuple{Any}","page":"Development","title":"Obliqua.Love.expand_layers","text":"expand_layers(r; nr::Int=80)\n\nDiscretize the primary layers given by r into nr discrete secondary layers.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.find_mush_index-Tuple{Any}","page":"Development","title":"Obliqua.Love.find_mush_index","text":"find_mush_index(ϕ)\n\nFind the mush region using ϕ (melt fraction) profile.:\n\nIdentify all indices where ϕ ≠ 0.\nPartition these into connected segments.\nPick the connected segment with the smallest starting index\n\n(the shallowest mush layer).\n\nReturn the largest index in that segment (bottom of mush).\n\nReturns nothing if ϕ is zero everywhere.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_A!-Tuple{Matrix, Vararg{Any, 13}}","page":"Development","title":"Obliqua.Love.get_A!","text":"get_A!(A::Matrix, r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)\n\nCompute the 8x8 A matrix in the ODE for the two-phase problem. These correspond to  the coefficients given in Equation S4.6 in Hay et al., (2025).\n\nSee also get_A\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_A!-Tuple{Matrix, Vararg{Any, 5}}","page":"Development","title":"Obliqua.Love.get_A!","text":"get_A!(r, ρ, g, μ, K; λ=nothing)\n\nCompute the 6x6 A matrix in the ODE for the solid-body problem. These correspond to  the coefficients given in Equation S4.6 in Hay et al., (2025) when α=φ=0, as well as Sabadini and Vermeersen  (2016) Eq. 1.95.\n\nSee also get_A\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_A-NTuple{13, Any}","page":"Development","title":"Obliqua.Love.get_A","text":"get_A(A::Matrix, r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)\n\nCompute the 8x8 A matrix in the ODE for the two-phase problem. These correspond to  the coefficients given in Equation S4.6 in Hay et al., (2025).\n\nSee also get_A!\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_A-NTuple{5, Any}","page":"Development","title":"Obliqua.Love.get_A","text":"get_A(r, ρ, g, μ, K)\n\nCompute the 6x6 A matrix in the ODE for the solid-body problem.\n\nSee also get_A!\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_B!-NTuple{16, Any}","page":"Development","title":"Obliqua.Love.get_B!","text":"get_B!(B, r1, r2, g1, g2, ρ, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)\n\nCompute the 8x8 numerical integrator matrix, which integrates dy/dr from r1 to r2 for the two-phase problem.\n\nB here represnts the RK4 integrator, given by Eq. S5.5 in Hay et al., (2025).\n\nSee also get_B\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_B!-NTuple{8, Any}","page":"Development","title":"Obliqua.Love.get_B!","text":"get_B!(B, r1, r2, g1, g2, ρ, μ, K)\n\nCompute the 6x6 numerical integrator matrix, which integrates dy/dr from r1 to r2 for the solid-body problem.\n\nB here represnts the RK4 integrator, given by Eq. S5.5 in Hay et al., (2025).\n\nSee also get_B\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_B-NTuple{15, Any}","page":"Development","title":"Obliqua.Love.get_B","text":"See 'get_B!' for definition.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_B-NTuple{7, Any}","page":"Development","title":"Obliqua.Love.get_B","text":"See 'get_B!' for definition.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_B_product!-NTuple{14, Any}","page":"Development","title":"Obliqua.Love.get_B_product!","text":"get_B_product!(Brod, r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)\n\nCompute the product of the 8x8 B matrices within a primary layer. This is used to propgate the y solution across a single two-phase primary layer.\n\nBprod is denoted by D in Eq. S5.14 in Hay et al., (2025).\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_B_product!-NTuple{6, Any}","page":"Development","title":"Obliqua.Love.get_B_product!","text":"get_B_product!(Brod, r, ρ, g, μ, K)\n\nCompute the product of the 6x6 B matrices within a primary layer. This is used to propgate the y solution across one single-phase (solid) primary layer.\n\nBprod is denoted by D in Eq. S5.14 in Hay et al., (2025).\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_Ic-NTuple{5, Any}","page":"Development","title":"Obliqua.Love.get_Ic","text":"Get the core solution vector\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_g-Tuple{Any, Any}","page":"Development","title":"Obliqua.Love.get_g","text":"get_g(r, ρ)\n\nCompute the radial gravity structure associated with a density profile r at intervals given by r.\n\nr must be be a 2D array, with index 1 representing the top radius of secondary layers, and index 2 representing the top radius of primary layers. \n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_heating_map-NTuple{15, Any}","page":"Development","title":"Obliqua.Love.get_heating_map","text":"function get_heating_map(y, r, ρ, g, μ, Ks, ω, ρl, Kl, Kd, α, ηl, ϕ, k, ecc; vol=false)\n\nGet a surface heating map for two-phase tides and eccentricity forcing, assuming synchronous rotation. Heating rate is computed with numerical integration using the solution  y returned by compute_y,  using Eq. 2.39a/b/c integrated in radius.  The forcing magnitude is determined by orbital frequency ω and eccentricity ecc. \n\nReturns the radially integrated heating maps in W/m^2 for dissipation due to shear,  compaction, and Darcy flow. If vol=true, then additional volumentric heating arrays  will also be returned in W/m^3.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_heating_map-NTuple{8, Any}","page":"Development","title":"Obliqua.Love.get_heating_map","text":"get_heating_map(y, r, ρ, g, μ, κ, ω, ecc; vol=false)\n\nGet a surface heating map for solid-body tides and eccentricity forcing, assuming synchronous rotation. Heating rate is computed  with numerical integration using the solution y returned by compute_y,  using Eq. 2.39a/b integrated in radius.  The forcing magnitude is determined by orbital frequency ω and eccentricity ecc. \n\nReturns the radially integrated heating maps in W/m^2 for dissipation due to shear  and compaction. If vol=true, then additional volumentric heating arrays  will also be returned in W/m^3.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_heating_profile-NTuple{15, Any}","page":"Development","title":"Obliqua.Love.get_heating_profile","text":"get_heating_profile(y, r, ρ, g, μ, Ks, ω, ρl, Kl, Kd, α, ηl, ϕ, k, ecc; lay=nothing)\n\nGet the radial volumetric heating for two-phase tides and eccentricity forcing, assuming synchronous rotation. Heating rate is computed with numerical integration using the solution  y returned by compute_y,  using Eq. 2.39a/b/c integrated over solid angle.  The forcing magnitude is determined by orbital frequency ω and eccentricity ecc.  The heating profile for a specific layer is specified with lay, otherwise all  layers will be caclulated.\n\nReturns the angular averaged volumetric heating profiles in W/m^3 for dissipation due to shear,  compaction and Darcy flow, as well as the total power dissipated in each primary layer.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_heating_profile-NTuple{8, Any}","page":"Development","title":"Obliqua.Love.get_heating_profile","text":"function get_heating_profile(y, r, ρ, g, μ, κ, ω, ecc; lay=nothing)\n\nGet the radial volumetric heating for solid-body tides and eccentricity forcing, assuming synchronous rotation. Heating rate is computed with numerical integration using the solution  y returned by compute_y,  using Eq. 2.39a/b integrated over solid angle.  The forcing magnitude is determined by orbital frequency ω and eccentricity ecc.  The heating profile for a specific layer is specified with lay, otherwise all  layers will be caclulated.\n\nReturns the angular averaged volumetric heating profiles in W/m^3 for dissipation due to shear  and compaction, as well as the power dissipated in each primary layer in W/m^3.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_solution-NTuple{10, Any}","page":"Development","title":"Obliqua.Love.get_solution","text":"get_solution(y, n, m, r, ρ, g, μ, K, ω)\n\nExpand the tidal solution from y at degree n and order m. \n\nPrerequisite calls\n\nNote that define_spherical_grid() must be called first.\n\nReturns\n\nA tuple of the complex fourier coefficients on a lat-lon grid for \n\ndisplacement, u \nsolid strain, εs \ntotal stress, σ \n\nFor tensors, the array dimensions represent (nlat, nlon, 6xtensor components, secondary lay., primary lay.) For vectors, the array dimensions represent (nlat, nlon, 3xvector components, secondary lay., primary lay.) For scalars, the array dimensions represent (nlat, nlon, secondary lay., primary lay.)\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_solution-NTuple{16, Any}","page":"Development","title":"Obliqua.Love.get_solution","text":"get_solution(y, n, m, r, ρ, g, μ, K, ω, ρₗ, Kl, Kd, α, ηₗ, ϕ, k)\n\nExpand the tidal solution from y at degree n and order m. \n\nPrerequisite calls\n\nNote that define_spherical_grid() must be called first.\n\nReturns\n\nA tuple of the complex fourier coefficients on a lat-lon grid for \n\ndisplacement, u \nsolid strain, εs \ntotal stress, σ \npore pressure, pl \ndarcy (relative) displacement, u_rel\n\nFor tensors, the array dimensions represent (nlat, nlon, 6xtensor components, secondary lay., primary lay.) For vectors, the array dimensions represent (nlat, nlon, 3xvector components, secondary lay., primary lay.) For scalars, the array dimensions represent (nlat, nlon, secondary lay., primary lay.)\n\nTo recover the real solution at time t, the forcing magnitude and direction must be known. \n\nExample\n\nsol_22 = get_solution(y1, 2, 2, rr, ρ, g, μ, κs, ω, ρl, κl, κd, α, ηl, ϕ, k);\nsol_20  = get_solution(y1, 2,  0, rr, ρ, g, μ, κs, ω, ρl, κl, κd, α, ηl, ϕ, k);\n\n# eccentricity forcing \nU22E =  7/8 * ω^2*R^2*ecc \nU22W = -1/8 * ω^2*R^2*ecc \nU20  = -3/2 * ω^2*R^2*ecc \n\nY = Love.clats;\nX = Love.lons;\nP20 = 0.5 .* (3 .* cos.(Y).^2 .- 1)\nP22 = 3 .* (1. .- cos.(Y).^2)\n\n# define phase of solution (0 to 2pi)\nωt = 0.0\n\n# Obtain the radial tide\n# Combine the solutions - note that the west component is a complex conjugate\ntide = (U22E*sol_22[1] + U20*sol_20[1])[:,:,1,end,end] \n        .+ U22W*conj.(sol_22[1])[:,:,1,end,end];\ntide = 0.5real.(tide .* exp(-1im * ωt) .+ conj.(tide) .* exp(1im * ωt));\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.get_total_heating-NTuple{4, Any}","page":"Development","title":"Obliqua.Love.get_total_heating","text":"get_total_heating(y, ω, R, ecc)\n\nGet the total heating rate for solution y due to orbital eccentricity e  for a body with synchronous rotation rate ω and radius R.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Love.set_G-Tuple{Any}","page":"Development","title":"Obliqua.Love.set_G","text":"set_G(new_G)\n\nOverwrite the value of the Universal Gravitational Constant. Only to be used for non-dimensional calculations!\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Fluid.compute_fluid_lovenumbers-Tuple{Float64, BigFloat, BigFloat, BigFloat, BigFloat, Int64, Float64}","page":"Development","title":"Obliqua.Fluid.compute_fluid_lovenumbers","text":"compute_fluid_lovenumbers(omega, R, H_magma, g, ρ_ratio, n, σ_R)\n\nCalculate k2 lovenumbers in fluid.\n\nArguments\n\nomega::Float64                  : Forcing frequency range.\nR::prec                         : Outer radius of fluid segment in mantle.\nH_magma::prec                   : Height of fluid segment in mantle.\ng::prec                         : Surface gravity at top of fluid segment in mantle.\nρ_ratio::prec                   : Density contrast between current (fluid) and lower (non-fluid) layer.\nn::Int=2                        : Power of the radial factor (goes with (r/a)^{n}, since r<<a only n=2 contributes significantly).\nsigma_R::Float64=1e-3           : Rayleigh drag coefficient.\n\nReturns\n\nk2_T::precc                     : Complex Tidal k2 Lovenumber.\nk2_L::precc                     : Complex Load k2 Lovenumber.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Fluid.heat_profile-Tuple{BigFloat, Vector{BigFloat}, Vector{BigFloat}}","page":"Development","title":"Obliqua.Fluid.heat_profile","text":"heat_profile(power, ρ, r)\n\nConstruct 1D uniform heating profile.\n\nArguments\n\npower::prec                     : Total dissipated power.\nρ::Array{prec,1}                : Density profile of the planet.\nr::Array{prec,1}                : Radial positions of layers, from bottom to top of segment.\n\nReturns\n\npower_prf::Array{prec,1}        : Heating profile.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Fluid.mean_rho-Tuple{Vector{BigFloat}, Vector{BigFloat}}","page":"Development","title":"Obliqua.Fluid.mean_rho","text":"mean_rho(ρ, r)\n\nCalculate the mean density in segment.\n\nArguments\n\nρ::Array{prec,1}                : Density profile of the planet.\nr::Array{prec,1}                : Radial positions of layers, from bottom to top of segment.\n\nReturns\n\nmean_density::prec              : Mean density in segment.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Solid.compute_solid_lovenumbers-Tuple{Complex{BigFloat}, BigFloat, BigFloat, Int64}","page":"Development","title":"Obliqua.Solid.compute_solid_lovenumbers","text":"compute_solid_lovenumbers(omega, R, H_magma, g, ρ_ratio, n, σ_R)\n\nCalculate k2 lovenumbers in solid.\n\nArguments\n\nomega::Float64                  : Forcing frequency range.\nR::prec                         : Outer radius of fluid segment in mantle.\nH_magma::prec                   : Height of fluid segment in mantle.\ng::prec                         : Surface gravity at top of fluid segment in mantle.\nρ_ratio::prec                   : Density contrast between current (fluid) and lower (non-fluid) layer.\nn::Int=2                        : Power of the radial factor (goes with (r/a)^{n}, since r<<a only n=2 contributes significantly).\nsigma_R::Float64=1e-3           : Rayleigh drag coefficient.\n\nReturns\n\nk2_T::precc                     : Complex Tidal k2 Lovenumber.\nk2_L::precc                     : Complex Load k2 Lovenumber.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Solid.mean_cmu-Tuple{Vector{Complex{BigFloat}}, Vector{BigFloat}}","page":"Development","title":"Obliqua.Solid.mean_cmu","text":"mean_cmu(μc, r)\n\nCalculate the Hill-averaged complex shear modulus in a spherical segment (Hill+1952).\n\nArguments\n\nμc::Array{precc,1}              : Complex shear modulus profile of the planet.\nr::Array{prec,1}                : Radial positions of layers, from bottom to top of segment.\n\nReturns\n\nmean_μc::precc                  : Mean complex shear modulus in segment.\n\nNotes\n\n(DOI 10.1088/0370-1298/65/5/307)\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Hansen.get_hansen-Tuple{Any, Vararg{Int64, 4}}","page":"Development","title":"Obliqua.Hansen.get_hansen","text":"get_hansen(ecc)\n\nWrapper used in your original code: computes Hansen coefficients for given eccentricity. Relies on global n, m, kmin, kmax.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Hansen.hansen_fft-NTuple{5, Any}","page":"Development","title":"Obliqua.Hansen.hansen_fft","text":"hansen_fft(n, m, e, kmin, kmax; N=nothing)\n\nCompute Hansen coefficients X_k^{n,m}(e) using FFT on mean anomaly.\n\nReturns a tuple (k, Xkm), where:\n\nk is a vector of integer k-indices\nXkm are the corresponding Hansen coefficients (real part)\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Hansen.kepler_newton-Tuple{Any, Any}","page":"Development","title":"Obliqua.Hansen.kepler_newton","text":"kepler_newton(M, e)\n\nSolve Kepler’s equation  E - e*sin(E) = M for the eccentric anomaly E, using Newton iteration. M may be scalar or array.\n\n\n\n\n\n","category":"method"},{"location":"development/#Obliqua.Hansen.nextpow2_int-Tuple{Int64}","page":"Development","title":"Obliqua.Hansen.nextpow2_int","text":"nextpow2_int(x)\n\nReturn the integer p such that 2^p ≥ x.\n\n\n\n\n\n","category":"method"},{"location":"reference/tidal-potentials/#Reference-(7)","page":"7 - Tidal Potentials","title":"Reference (7)","text":"","category":"section"},{"location":"reference/tidal-potentials/#Tidal-potentials","page":"7 - Tidal Potentials","title":"Tidal potentials","text":"Different sources can provide different tidal potentials, first we need to complete the solid-phase by providng the relevant surface boundary condition. Here we list some examples.","category":"section"},{"location":"reference/tidal-potentials/#Loaded-Surface","page":"7 - Tidal Potentials","title":"Loaded Surface","text":"For an impermeable load,\n\ny_2 =  - frac(2ell + 1) g(R)4 pi G R qquad y_4 = 0 qquad y_6 = frac2ell + 1R qquad y_8 = 0\n\nwhere g(R) is the gravitational acceleration at the surface (e.g., Saito, 1974).","category":"section"},{"location":"reference/tidal-potentials/#Lunar-Tide","page":"7 - Tidal Potentials","title":"Lunar Tide","text":"For a fully solid mantle, the boundary conditions at the surface are\n\ny_3 = y_4 = 0 qquad y_6 = - frac(2ell + 1) g_s4 fracM_MM_E left(fracR_Earight)^3\n\n(see Takeuchi et al. 1972).\n\nThe final condition is\n\npmbP_1pmby(a^-) =\nbeginpmatrix\n0 1em\n0 1em\n-dfrac(2ell+1) g_s4\ndfracM_MM_E\nleft(dfracR_Earight)^3\nendpmatrix\n\nAfter having solved and generated the k_2 (sigma) spectrum, we can find the power input from tides.","category":"section"},{"location":"reference/tidal-potentials/#Tidal-Dissipation","page":"7 - Tidal Potentials","title":"Tidal Dissipation","text":"The mode amplitude of the external tidal potential is\n\nU_22k =\nfracG M_stara\nleft(fracRaright)^2\nsqrtfrac6pi5X_22k(e)\n\nThe tidal power per mode is\n\nP_Tk =\nfrac5 R sigma8pi G\nImbiglk_2(sigma)bigr\nU_22k^2\n\nSuch that the total tidal dissipation:\n\nP_mathrmtidal = -sum_k P_Tk\n\n","category":"section"},{"location":"tutorials/running-model/#Tutorials-(2)","page":"2 - Running Model","title":"Tutorials (2)","text":"","category":"section"},{"location":"tutorials/running-model/#Running-Model","page":"2 - Running Model","title":"Running Model","text":"Now that you are able to validate and load data files using the Obliqua.load module, we can start using the tidal models  Obliqua.Solid, Obliqua.Love and Obliqua.Fluid. In principle, this is rather simple, since you only have to call one function depending on your use case. For example, let us proceed with the data file from Loading data. In this case, following the Table of inputs, we are interested in the solid-phase tides only, so we may use the Obliqua.calc_solid_tides function. \n\nwarning: Warning\nNewer versions of the code will stop using the distinct phase calc_..._tides functions, instead all models can be accessed through run_tides.\n\nusing Obliqua\n\n# location of data files\nRES_DIR = \"/path/to/Obliqua/res\"\n\n# use the relevant load function\nomega, ecc, rho, radius, visc, shear, bulk, ncalc = Obliqua.load.load_interior(\"$RES_DIR/interior_data/test_mantle.json\", false)\n\n# call the desired model\npower_prf, power_blk, imag_k2 = Obliqua.calc_solid_tides(omega, ecc, rho, radius, visc, shear, bulk; ncalc=ncalc, material=\"maxwell\")\n\n\nIn general, we can use \n\nTides Function\nsolid-phase Obliqua.calc_solid_tides\nsolid-phase + mush interface Obliqua.calc_solid_tides_mush\nliquid-phase Obliqua.calc_fluid_tides\nmixed-phase Obliqua.run_tides\n\n\n\n\n\n\n\n","category":"section"},{"location":"tutorials/running-model/#Obliqua.calc_fluid_tides-Tuple{BigFloat, BigFloat, BigFloat, BigFloat, BigFloat, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}}","page":"2 - Running Model","title":"Obliqua.calc_fluid_tides","text":"calc_fluid_tides(omega, axial, ecc, sma, S_mass, rho, radius, visc; \n                N_sigma=301, visc_l=5e2, visc_s=5e21, sigma_R=1e-3)\n\nCalculate the tidal heating in the fluid layers of a planetary interior.\n\nThis function computes the tidal dissipation power profile and the total tidal heating  for liquid layers using Love numbers, Hansen coefficients, and a viscoelastic  approximation for the solid interior. It also returns the k2 Love number at the  forcing frequency used by the calculation.\n\nArguments\n\nomega::prec : Orbital frequency of the planet [rad/s].\naxial::prec : Axial rotation frequency of the planet [rad/s].\necc::prec   : Orbital eccentricity.\nsma::prec   : Semi-major axis of the orbit [m].\nS_mass::prec : Stellar mass [kg].\nrho::Array{prec,1} : Layered density profile [kg/m³].\nradius::Array{prec,1} : Layer boundaries [m], length = number of layers + 1.\nvisc::Array{prec,1} : Layer viscosities [Pa·s].\n\nKeyword Arguments\n\nN_sigma::Int=301 : Number of frequency bins for spectral calculations.\nvisc_l::Float64=5e2 : Threshold viscosity below which a layer is considered liquid [Pa·s].\nvisc_s::Float64=5e21 : Threshold viscosity above which a layer is considered solid [Pa·s].\nsigma_R::Float64=1e-3 : Rayleigh drag coefficient for the fluid interface [1/s].\n\nReturns\n\nA tuple with three elements:\n\npower_prf::Vector{Float64} : Tidal heating power profile for each layer [W].\nP_tidal_total::Float64 : Total tidal dissipation power in the fluid layers [W].\nk2_total::Float64 : Complex k2 Love number at the forcing frequency.\n\nErrors\n\nThrows an error if:\n\nNo liquid layers are found in the interior (ρ_l empty), suggesting that visc_l needs adjustment.\nThe interior structure is incompatible with computing mean densities.\n\nNotes\n\nLayers are categorized into liquid, mush, and solid based on visc_l and visc_s.\nr_b denotes the bottom of the liquid region.\nHansen coefficients and Love numbers are computed over a frequency spectrum and interpolated.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.calc_solid_tides-Tuple{BigFloat, BigFloat, Vararg{Vector{BigFloat}, 5}}","page":"2 - Running Model","title":"Obliqua.calc_solid_tides","text":"calc_solid_tides(omega, ecc, rho, radius, visc, shear, bulk; ncalc=2000, material=\"andrade\")\n\nCalculate tidal heating in a solid planetary interior using the Love number approach (Love.jl).\n\nArguments\n\nomega::prec : Forcing angular frequency (rad/s).  \necc::prec : Orbital eccentricity.  \nrho::Vector{prec} : Radial density profile (kg/m³), first element = core.  \nradius::Vector{prec} : Radial grid points corresponding to rho (m).  \nvisc::Vector{prec} : Viscosity profile (Pa·s).  \nshear::Vector{prec} : Shear modulus profile (Pa).  \nbulk::Vector{prec} : Bulk modulus profile (Pa).  \n\nKeyword Arguments\n\nncalc::Int=2000 : Number of subdivisions for radial layers.  \nmaterial::String=\"andrade\" : Rheology model for complex shear modulus. Options: \"maxwell\", \"andrade\".\n\nReturns\n\nA tuple (power_prf, power_blk, k2_im):\n\npower_prf::Vector{Float64} : Tidal heating profile per unit mass (W/kg).  \npower_blk::Float64 : Total bulk tidal heating (W).  \nk2_im::Float64 : Imaginary part of the complex tidal Love number k2 at the forcing frequency.  \n\nNotes\n\nImplements Efroimsky (2012) equations for viscoelastic response.  \nShear and bulk heating contributions are computed separately and summed.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.calc_solid_tides_mush-Tuple{BigFloat, BigFloat, Vararg{Vector{BigFloat}, 6}}","page":"2 - Running Model","title":"Obliqua.calc_solid_tides_mush","text":"calc_solid_tides_mush(omega, ecc, rho, radius, visc, shear, bulk, phi;\n                        ncalc=2000, material=\"andrade\", visc_l=1e2,\n                        bulk_l=1e9, permea=1e-7)\n\nCalculate tidal heating in a partially molten planetary interior with a mush region.\n\nArguments\n\nomega::prec : Forcing angular frequency (rad/s).  \necc::prec : Orbital eccentricity.  \nrho::Vector{prec} : Radial density profile (kg/m³), first element = core.  \nradius::Vector{prec} : Radial grid points corresponding to rho (m).  \nvisc::Vector{prec} : Viscosity profile (Pa·s).  \nshear::Vector{prec} : Shear modulus profile (Pa).  \nbulk::Vector{prec} : Bulk modulus profile (Pa).  \nphi::Vector{prec} : Melt fraction profile (0–1) for each layer.\n\nKeyword Arguments\n\nncalc::Int=2000 : Number of subdivisions for radial layers.  \nmaterial::String=\"andrade\" : Rheology model for complex shear modulus. Options: \"maxwell\", \"andrade\".  \nvisc_l::Float64=1e2 : Liquid viscosity in mush region (Pa·s).  \nbulk_l::Float64=1e9 : Bulk modulus of liquid in mush region (Pa).  \npermea::Float64=1e-7 : Permeability of mush region (m²).\n\nReturns\n\nA tuple (power_prf, power_blk, k2_im):\n\npower_prf::Vector{Float64} : Tidal heating profile per unit mass (W/kg).  \npower_blk::Float64 : Total bulk tidal heating (W).  \nk2_im::Float64 : Imaginary part of the complex tidal Love number k2 at the forcing frequency.  \n\nNotes\n\nAccounts for porosity and partial melt (mush) effects on tidal dissipation.  \nUses drained and Biot moduli to handle fluid–solid coupling.  \nThrows an error if no mush region is identified (phi insufficient).\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.complex_mu-Tuple{AbstractVector, Vector{Complex{BigFloat}}, Vector{BigFloat}}","page":"2 - Running Model","title":"Obliqua.complex_mu","text":"complex_mu(σ_range, μ_profile, η_profile; material=\"andrade\", α=0.3)\n\nReturn the complex shear modulus μ̃(σ) for Maxwell or Andrade rheology.\n\nArguments\n\nσ_range::AbstractVector         : Forcing frequency range.\nμ_profile::Array{precc,1}       : Shear profile of the planet (aka unrelaxed rigidity).\nη_profile::Array{prec,1}        : Viscosity profile of the planet.\n\nKeyword Arguments\n\nmaterial::String=\"andrade\"      : Material for which to find complex shear modulus.\nα::Float64=0.3\"                 : Power-law exponent (free parameter).\n\nReturns\n\nμc::Matrix{precc}               : Complex shear modulus profile at all forcing frequencies.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.get_layers-Tuple{Vector{BigFloat}, Vector{BigFloat}, Float64, Float64}","page":"2 - Running Model","title":"Obliqua.get_layers","text":"get_layers(r, η, η_l, η_s; min_frac=0.02)\n\nDetermine the phase profile of a planetary interior considering solid, fluid, and mush layers.\n\nArguments\n\nr::Array{prec,1}                : Radial positions of layers, from core to surface.\nη::Array{prec,1}                : Viscosity profile of the planet.\nη_l::Float64                    : Liquidus viscosity.\nη_s::Float64                    : Solidus viscosity.\n\nKeyword Arguments\n\nmin_frac::Float64=0.02          : Minimal segment radius fraction before smoothing.\n\nReturns\n\nmask_s::Vector{Bool}            : Solid region mask.\nmask_l::Vector{Bool}            : Fluid region mask.\nmask_c::Vector{Bool}            : Mush region mask.\nis_seg::Vector{Tuple{Int,Int}}  : Segment [start, stop] index array.\nsegments::Vector{String}        : Segment phase array.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.open_config-Tuple{String}","page":"2 - Running Model","title":"Obliqua.open_config","text":"Open and validate config file.\n\nArguments:\n\ncfg_path::String                : Path to configuration file\n\nReturns:\n\ncfg_dict::Dict                  : Dictionary containing the configuration\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.radial_heating_profile-Tuple{Vector, Vector, Real}","page":"2 - Running Model","title":"Obliqua.radial_heating_profile","text":"radial_heating_profile(r, mu, Ptot)\n\nCompute a spherically symmetric volumetric heating profile H(r) [W/m^3]\n\nArguments\n\nk2_L::precc                     : Complex Load k2 Lovenumber.\nr::Vector                       : Radial positions of layers, from core to surface.\nmu::Vector                      : Complex shear modulus profile of the planet.\nPtot::Real                      : Totally dissipated power (W)\n\nReturns\n\nH::Vector                       : Heating profile.\n\nHeating is assumed proportional to Im(μ(r)) and normalized so the integral of H over the volume equals Ptot.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.run_fluid-Tuple{Float64, Vector{BigFloat}, Vector{BigFloat}, BigFloat}","page":"2 - Running Model","title":"Obliqua.run_fluid","text":"run_fluid(omega, rho, radius, ρ_ratio; n=2, sigma_R=1e-3)\n\nCalculate k2 Lovenumbers in the fluid.\n\nArguments\n\nomega::Float64                  : Forcing frequency range.\nrho::Array{prec,1}              : Density profile of the planet.\nradius::Array{prec,1}           : Radial positions of layers, from core to surface.\nρ_ratio::prec                   : Density contrast between current (fluid) and lower (non-fluid) layer.\n\nKeyword Arguments\n\nn::Int=2                        : Power of the radial factor (goes with (r/a)^{n}, since r<<a only n=2 contributes significantly).\nsigma_R::Float64=1e-3           : Rayleigh drag coefficient.\n\nReturns\n\nk2_T::precc                     : Complex Tidal k2 Lovenumber.\nk2_L::precc                     : Complex Load k2 Lovenumber.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.run_solid_0d-Tuple{Vector{Complex{BigFloat}}, Vector{BigFloat}, BigFloat}","page":"2 - Running Model","title":"Obliqua.run_solid_0d","text":"run_solid_0d(μc, radius, mass_tot; n=2)\n\nCalculate k2 Lovenumbers in the 0d solid.\n\nArguments\n\nμc::Array{precc,1}              : Forcing frequency range.\nradius::Array{prec,1}           : Radial positions of layers, from core to surface.\nmass_tot::Float64               : Total mass of planet.\n\nKeyword Arguments\n\nn::Int=2                        : Power of the radial factor (goes with (r/a)^{n}, since r<<a only n=2 contributes significantly).\n\nReturns\n\nk2_T::precc                     : Complex Tidal k2 Lovenumber.\nk2_L::precc                     : Complex Load k2 Lovenumber.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.run_solid_1d-Tuple{Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}, Vector{Complex{BigFloat}}, Vector{BigFloat}}","page":"2 - Running Model","title":"Obliqua.run_solid_1d","text":"run_solid_1d(rho, radius, visc, shear, bulk; ncalc=2000, n=2)\n\nUse 1D solid tides model to calculate k2 Lovenumbers.\n\nArguments\n\nrho::Array{prec,1}              : Density profile of the planet.\nradius::Array{prec,1}           : Radial positions of layers, from core to surface.\nvisc::Array{prec,1}             : Viscosity profile of the planet.\nμ_profile::Array{precc,1}       : Complex shear modulus profile of the planet.\nbulk::Array{prec,1}             : Bulk modulus profile of the planet.\n\nKeyword Arguments\n\nncalc::Int=1000                 : Number of sublayers.\nn::Int=2                        : Power of the radial factor (goes with (r/a)^{n}, since r<<a only n=2 contributes significantly).\n\nReturns\n\nk2_T::precc                     : Complex Tidal k2 Lovenumber.\nk2_L::precc                     : Complex Load k2 Lovenumber.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.run_solid_1d_strain-Tuple{Float64, BigFloat, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}, Vector{Complex{BigFloat}}, Vector{BigFloat}}","page":"2 - Running Model","title":"Obliqua.run_solid_1d_strain","text":"run_solid_1d_strain(omega, ecc, rho, radius, visc, shear, bulk; ncalc=2000, n=2)\n\nUse 1D solid tides model to calculate k2 Lovenumbers, and compute 1D heating profile from strain tensor.\n\nArguments\n\nomega::Float64                  : Forcing frequency range.\necc::prec                       : Eccentricity of the orbit.\nrho::Array{prec,1}              : Density profile of the planet.\nradius::Array{prec,1}           : Radial positions of layers, from core to surface.\nvisc::Array{prec,1}             : Viscosity profile of the planet.\nμ_profile::Array{precc,1}       : Complex shear modulus profile of the planet.\nbulk::Array{prec,1}             : Bulk modulus profile of the planet.\n\nKeyword Arguments\n\nncalc::Int=1000                 : Number of sublayers.\nn::Int=2                        : Power of the radial factor (goes with (r/a)^{n}, since r<<a only n=2 contributes significantly).\n\nReturns\n\npower_prf::Array{prec,1}        : Heating profile.\nk2_T::precc                     : Complex Tidal k2 Lovenumber.\nk2_L::precc                     : Complex Load k2 Lovenumber.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.run_solid_mush_1d-Tuple{Float64, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}, Vector{Complex{BigFloat}}, Vector{BigFloat}, Vector{BigFloat}}","page":"2 - Running Model","title":"Obliqua.run_solid_mush_1d","text":"run_solid_mush_1d(omega, rho, radius, visc, shear, bulk, phi; ncalc=2000, n=2, visc_l=1e2, bulk_l=1e9, permea=1e-7, porosity_thresh=1e-5)\n\nUse 1D solid tides model with mush interface to calculate k2 Lovenumbers.\n\nArguments\n\nomega::Float64                  : Forcing frequency.\nrho::Array{prec,1}              : Density profile of the planet.\nradius::Array{prec,1}           : Radial positions of layers, from core to surface.\nvisc::Array{prec,1}             : Viscosity profile of the planet.\nshear::Array{precc,1}           : Complex shear modulus profile of the planet.\nbulk::Array{prec,1}             : Bulk modulus profile of the planet.\nphi::Array{prec,1}              : Melt fraction (porosity) profile of the planet.\n\nKeyword Arguments\n\nncalc::Int=1000                 : Number of sublayers.\nn::Int=2                        : Power of the radial factor (goes with (r/a)^{n}, since r<<a only n=2 contributes significantly).\nvisc_l::Float64=1e2             : Liquid viscosity.\nbulk_l::Float64=1e9             : Liquid bulk modulus.\npermea::Float64=1e-7            : Permeability of mush layer.\nporosity_thresh::Float64=1e-5   : Porosity threshold, below this value no mush.\n\nReturns\n\nk2_T::precc                     : Complex Tidal k2 Lovenumber.\nk2_L::precc                     : Complex Load k2 Lovenumber.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.run_solid_mush_1d_strain-Tuple{Float64, BigFloat, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}, Vector{Complex{BigFloat}}, Vector{BigFloat}, Vector{BigFloat}}","page":"2 - Running Model","title":"Obliqua.run_solid_mush_1d_strain","text":"run_solid_mush_1d_strain(omega, ecc, rho, radius, visc, shear, bulk, phi; ncalc=2000, n=2, visc_l=1e2, bulk_l=1e9, permea=1e-7, porosity_thresh=1e-5)\n\nUse 1D solid tides model with mush interface to calculate k2 Lovenumbers, and compute 1D heating profile from strain tensor.\n\nArguments\n\nomega::Float64                  : Forcing frequency range.\necc::prec                       : Eccentricity of the orbit.\nrho::Array{prec,1}              : Density profile of the planet.\nradius::Array{prec,1}           : Radial positions of layers, from core to surface.\nvisc::Array{prec,1}             : Viscosity profile of the planet.\nshear::Array{precc,1}           : Complex shear modulus profile of the planet.\nbulk::Array{prec,1}             : Bulk modulus profile of the planet.\nphi::Array{prec,1}              : Melt fraction (porosity) profile of the planet.\n\nKeyword Arguments\n\nncalc::Int=1000                 : Number of sublayers.\nn::Int=2                        : Power of the radial factor (goes with (r/a)^{n}, since r<<a only n=2 contributes significantly).\nvisc_l::Float64=1e2             : Liquid viscosity.\nbulk_l::Float64=1e9             : Liquid bulk modulus.\npermea::Float64=1e-7            : Permeability of mush layer.\nporosity_thresh::Float64=1e-5   : Porosity threshold, below this value no mush.\n\nReturns\n\npower_prf::Array{prec,1}        : Heating profile.\nk2_T::precc                     : Complex Tidal k2 Lovenumber.\nk2_L::precc                     : Complex Load k2 Lovenumber.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/running-model/#Obliqua.run_tides-Tuple{BigFloat, BigFloat, BigFloat, BigFloat, BigFloat, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}, Vector{BigFloat}, Dict}","page":"2 - Running Model","title":"Obliqua.run_tides","text":"run_tides(omega, axial, ecc, sma, S_mass, rho, radius, visc, shear, bulk, cfg)\n\nCompute the tidal heating profile of a planetary interior considering solid and fluid layers.\n\nArguments\n\nomega::prec : Orbital frequency of the body.\naxial::prec : Axial (spin) frequency of the body.\necc::prec : Orbital eccentricity.\nsma::prec : Semi-major axis of the orbit.\nS_mass::prec : Mass of the central body (e.g., star) inducing tides.\nrho::Array{prec,1} : Radial density profile of the planet, from core to surface.\nradius::Array{prec,1} : Radial positions of layers, from core to surface.\nvisc::Array{prec,1} : Viscosity profile of the planet.\nshear::Array{prec,1} : Shear modulus profile of the solid layers.\nbulk::Array{prec,1} : Bulk modulus profile of the solid layers.\ncfg::Dict : Configuration parameters from dictionary.\n\nReturns\n\npower_prf::Array{Float64,1} : Radial profile of tidal heating (W/m³).\npower_blk::Float64 : Total tidal power integrated over the interior (W).\nσ_range::Array{Float64,1} : Frequencies at which the Love number k2 was evaluated.\nimag_k2::Array{Float64,1} : Imaginary part of the Love number k2 for the planet.\n\n\n\n\n\n","category":"method"},{"location":"install/#Getting-started","page":"Installation","title":"Getting started","text":"This page outlines requirements and installation steps for the code. Currently, GNU/Linux and MacOS (including ARM) are supported.","category":"section"},{"location":"install/#Software-requirements","page":"Installation","title":"Software requirements","text":"warning: Warning\nDo not install Julia using your system package manager. Install only from julialang.org as below.","category":"section"},{"location":"install/#Installation","page":"Installation","title":"Installation","text":"Follow the steps below in order to setup the code.\n\nInstall Julia's package manager: curl -fsSL https://install.julialang.org | sh\nSwitch to Julia 1.11: juliaup add 1.11 && juliaup default 1.11\nDownload Obliqua: git clone https://github.com/FormingWorlds/Obliqua.git\nChange directory: cd Obliqua\nOpen Julia package manager: julia, then press ]\nInstall: add https://github.com/FormingWorlds/Obliqua.git#julia","category":"section"},{"location":"install/#Testing","page":"Installation","title":"Testing","text":"If you want to run the tests manually, simply use the script in the test/ folder.\n\njulia test/runtests.jl\n\nThis will print information on whether tests passed or failed.","category":"section"},{"location":"reference/surface-loading/#Reference-(6)","page":"6 - Surface Loading","title":"Reference (6)","text":"","category":"section"},{"location":"reference/surface-loading/#Surface-Loading","page":"6 - Surface Loading","title":"Surface Loading","text":"","category":"section"},{"location":"reference/surface-loading/#Total-k_{2}","page":"6 - Surface Loading","title":"Total k_2","text":"To include a surface magma ocean, the full Love number is\n\nk_n(sigma) = k_Tn^(mathrmsolid)(sigma)\n+ bigl1 + k_Ln(sigma)bigrk_n^(mathrmfluid)(sigma)\n\nTo include a sub-surface magma ocean, the full Love number is\n\n\n\n","category":"section"},{"location":"tutorials/#Tutorials","page":"Tutorials","title":"Tutorials","text":"In this component you will be guided through the basic functionality of the Obliqua package.\n\nLoading data\nRunning Model\nPlotting","category":"section"},{"location":"how-to-guides/#How-to-Guides","page":"How-to guides","title":"How-to-Guides","text":"In this component you will be provided with more in-depth applications of the Obliqua package.","category":"section"},{"location":"ecosystem/#Related-codes","page":"Related codes","title":"Related codes","text":"Other components of the wider PROTEUS ecosystem may be found in the table below:\n\nCode Description Website\nPROTEUS Model coupling proteus-framework.org/PROTEUS\nJANUS Convective atmosphere proteus-framework.org/JANUS\nMORS Stellar evolution proteus-framework.org/MORS\nZEPHYRUS Hydrodynamic escape proteus-framework.org/ZEPHYRUS\nCALLIOPE Volatile outgassing proteus-framework.org/CALLIOPE\nAGNI RCE climate model proteus-framework.org/AGNI\nVULCAN Chemical kinetics github.com/FormingWorlds/VULCAN\nZalmoxis Interior structure zalmoxis.readthedocs.io\nAragog Interior dynamics github.com/FormingWorlds/aragog\nSPIDER Interior dynamics github.com/djbower/spider","category":"section"},{"location":"compass/#The-compass","page":"Compass","title":"The compass","text":"The documentation for Obliqua has been written based on the conventions prescribed in the Diátaxis project. At the core of Diátaxis are four different kinds of documentation. The compass provides a starting point for your search through these categories within the Obliqua documentation. \n\nIf the content… …and serves the user’s… …then it must belong to…\ninforms action acquisition of skill a tutorial\ninforms action application of skill a how-to guide\ninforms cognition application of skill reference\ninforms cognition acquisition of skill explanation\n\nFeel free to get started with any of these components.\n\nTutorials - learn the basics of Obliqua.\nHow-to-Guides - familiarize yourself with applications of Obliqua.\nReference - inform yourself with the theoretical discription of the model.\nExplanation - build conceptual understanding of model.\n\n","category":"section"},{"location":"explanation/#Explanation","page":"Explanation","title":"Explanation","text":"In this component you will build the conceptional understanding required for the Obliqua package.","category":"section"},{"location":"tutorials/plotting/#Tutorials-(3)","page":"3 - Plotting","title":"Tutorials (3)","text":"","category":"section"},{"location":"tutorials/plotting/#Plotting","page":"3 - Plotting","title":"Plotting","text":"Currently, there are two plotting scripts included with Obliqua. More will be added. \n\n\n\n\n\n\n\n","category":"section"},{"location":"tutorials/plotting/#Obliqua.plotting.plot_imagk2_spectrum-Tuple{Any, Any}","page":"3 - Plotting","title":"Obliqua.plotting.plot_imagk2_spectrum","text":"plot_imagk2_spectrum(σ_range, imag_k2; outpath)\n\nCreate and save a plot of the k2 Lovenumber as function of forcing frequency.\n\nArguments\n\nσ_range::Array{prec,1}          : Forcing frequency range.\nimag_k2::Array{precc,1}         : k2 Lovenumbers.\n\nKeyword Arguments\n\noutpathn::Union{Nothing,String}=nothing : If provided, the figure is saved to this path using savefig.\n\nReturns\n\nplt                             : The Plots.Plot object.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/plotting/#Obliqua.plotting.save_heat_profile-Tuple{AbstractVector, AbstractVector}","page":"3 - Plotting","title":"Obliqua.plotting.save_heat_profile","text":"save_heat_profile(radius, power_prf; filename=\"heat_profile.png\")\n\nCreate and save a plot of the heat dissipation profile as a function of radius.\n\nReturns\n\nplt : The Plots.Plot object.\n\n\n\n\n\n","category":"method"},{"location":"reference/#Reference","page":"Reference","title":"Reference","text":"In this component you will be guided through the employed formalism and theoretical background of the Obliqua package.\n\nRheology\nSolid-Phase\nMush layer\nLiquid-Phase\nForcing Frequency\nSurface Loading\nTidal potentials","category":"section"},{"location":"troubleshooting/#Troubleshooting","page":"Troubleshooting","title":"Troubleshooting","text":"This page may be useful if you are having problems.","category":"section"},{"location":"troubleshooting/#Julia-version-is-incompatible-/-Errors-about-OpenSSL-library","page":"Troubleshooting","title":"Julia version is incompatible / Errors about OpenSSL library","text":"You must use Julia version 1.11 because there are incompatibilities between the OpenSSL library required by Julia1.12 and Python. \n\nSwitch Julia versions using the juliaup command. E.g:\n\njuliaup status        # Show the versions you have installed\njuliaup add 1.11      # Install Julia 1.11\njuliaup default 1.11  # Make 1.11 your default version of Julia\njulia --version       # This should say 1.11.*\n\nAfter following these steps, try installing Obliqua again.","category":"section"},{"location":"troubleshooting/#Julia-errors-on-start,-potentially-referencing-the-CURL-library","page":"Troubleshooting","title":"Julia errors on start, potentially referencing the CURL library","text":"It is important that the shell environment variable LD_LIBRARY_PATH is not set when running Obliqua. This will cause Julia to use the wrong libraries, which will causes problems. You can unset this variable or reset using either of the following commands\n\nunset LD_LIBRARY_PATH\nexport LD_LIBRARY_PATH=\"\"\n\nIf this does not help, it's possible that you are using a Julia distribution provided by your system package manager. It's important that you only use Julia distributed from the official website.","category":"section"},{"location":"reference/mush-layer/#Reference-(3)","page":"3 - Mush layer","title":"Reference (3)","text":"","category":"section"},{"location":"reference/mush-layer/#Mush-layer","page":"3 - Mush layer","title":"Mush layer","text":"","category":"section"},{"location":"reference/solid-phase/#Reference-(2)","page":"2 - Solid-phase","title":"Reference (2)","text":"","category":"section"},{"location":"reference/solid-phase/#Solid-Phase","page":"2 - Solid-phase","title":"Solid-Phase","text":"To describe tidal and rotational deformations of a spherically symmetric body, Obliqua considers the spheroidal displacement–stress–gravity system. For each harmonic degree (ell) and order (m), the spheroidal perturbed state is represented by the 6-vector\n\n    mathbfy_ell m =\n    beginpmatrix\n    U_ell m \n    V_ell m \n    R_ell m \n    S_ell m \n    Phi_ell m \n    Q_ell m\n    endpmatrix\n\nwhere\n\nU_ell m: radial displacement\nV_ell m: tangential displacement\nR_ell m: radial stress\nS_ell m: tangential stress\nPhi_ell m: gravitational potential perturbation\nQ_ell m: “potential stress,” defined as\n\nQ_ell m\n= fracpartial Phi_ell mpartial r\n  + fracell+1rPhi_ell m\n  + 4pi G rho_0 U_ell m\n\nThe spheroidal vector satisfies the first-order ODE system\n\nfracdmathbfy_ell mdr\n= mathbfA_ell(r)mathbfy_ell m(r)\n\nHere, the coefficient matrix mathbfA_ell(r) represents the responds of the mantle to deformations, and is given by \n\nA(r) =\nbeginpmatrix\n-frac2lambdarbeta \nfracell(ell+1)lambdarbeta \nfrac1beta  0  0  0 12em\n\n-frac1r \nfrac1r \n0 \nfrac1mu \n0  0 12em\n\nfrac4rleft( frac3kappamurbeta - rho_0g right) - rho_0omega^2 \nfracell(ell+1)rleft(rho_0g - frac6kappamurbetaright) \n-frac4murbeta \nfracell(ell+1)r \n-fracrho_0(ell+1)r \nrho_0 12em\n\nfrac1rleft(rho_0g - frac6mukapparbetaright) \nfrac2mur^2leftell(ell+1)left(1+fraclambdabetaright)-1right - rho_0omega^2 \n-fraclambdarbeta \n-frac3r \nfracrho_0r \n0 12em\n\n-4pi G rho_0 \n0  0  0 \n-fracell+1r \n1 12em\n\n-frac4pi G rho_0 (ell+1)r \nfrac4pi G rho_0 ell(ell+1)r \n0  0  0 \nfracell-1r\nendpmatrix\n\nThe material parameters satisfy\n\nbeta = lambda + 2mu\n\nand\n\nlambda = kappa - frac23mu\n\n","category":"section"},{"location":"reference/solid-phase/#Core–Mantle-Boundary","page":"2 - Solid-phase","title":"Core–Mantle Boundary","text":"In order to solve the system a general solution is constructed through propagation from the core-mantle boundary outwards. At the CMB radius r_C, the spheroidal solution satisfies\n\nmathbfy_ell(r_C^+)\n  = mathbfI_C mathbfC\n\nwhere mathbfC = (C_1 C_2 C_3)^T is a vector of integration constants determined by surface boundary conditions. The CMB Interface Matrix is given as \n\nmathbfI_C =\nbeginpmatrix\n-psi_ell(r_C)g(r_C)  0  1 12em\n0  1  0 12em\n0  0  g(r_C)rho_0(r_C^-) 12em\n0  0  0 12em\npsi_ell(r_C)  0  0 12em\nq_ell(r_C)  0  4pi G rho_0(r_C^-)\nendpmatrix\n\nOnce the constants mathbfC are determined, the full perturbed state of the solid mantle is known.\n\n","category":"section"},{"location":"reference/solid-phase/#(Visco)elastic-Solution","page":"2 - Solid-phase","title":"(Visco)elastic Solution","text":"We propagate the solution using the so-called propagator matrix (pmbPi_ell). The propagator matrix solves the homogeneous differential system\n\nfracdpmbPi_ell(r r)dr = pmbA_ell(r)pmbPi_ell(r r)\n\nat radius r w.r.t. the solution at the previous layer r, this is also know as the Cauchy data at radius (r). If r = r we have\n\npmbPi_ell(r r) = pmb1\n\nEach column of the propagator matrix is one of the six linearly independent solutions of\n\nfracdpmby_ell mdr = pmbA_ell(r)pmby_ell m\n\nWe impose continuity:\n\npmbPi_ell(r_j^+ r) = pmbPi_ell(r_j^- r)\n\nand apply CMB boundary conditions:\n\npmby_ell m(r_C^+) = pmby_0 = pmbI_CpmbC\n\nTherefore,\n\npmby_ell m(r) =\npmbPi_ell(r r_C^+)pmbI_CpmbC\n\nThis equation can be solved iteratively, up till the surface to yield the general responds of the interior to any form of tidal- or load induced deformation.\n\n","category":"section"},{"location":"reference/solid-phase/#Surface-Boundary-Conditions","page":"2 - Solid-phase","title":"Surface Boundary Conditions","text":"Finally, to find the specific solution for the case where a planet is orbiting around a star-like object, we can specify the surface (r=a^-) boundary condition. In particular we need to constrain the 3rd, 4th, and 6th y-values. To do this employ the projector on the 3rd, 4th, and 6th components given by \n\npmbP_1pmby(a^-) =\npmbP_1 left\npmbPi_ell(a^- r_C^+)pmbI_CpmbC\nright\n= pmbb\n\nwhere\n\npmbb = sigma_ell m^Lpmbb^L +\nleft(Phi_ell m^T(a) + Phi_ell m^C(a)right)pmbb^T\n\nwith\n\npmbb^L =\nbeginpmatrix\n-dfrac(2ell+1)g(a)4pi a^2 1em\n0 1em\n-dfrac(2ell+1)Ga^2\nendpmatrix\nqquadtext(Load)\n\npmbb^T =\nbeginpmatrix\n0 1em\n0 1em\ndfrac2ell+1a\nendpmatrix\nqquadtext(Tidal)\n\nIncase the solid part of the mantle extends up to the surface of the planet, then the surface is stress-free and the toroidal part has sigma_ell m^L = pmb0, and the solution no longer depends on pmbb^L. However, as in our formalism the solid is often loaded by a liquid magma ocean, we cannot ignore this term.\n\nThe integration constants follow from\n\npmbC =\nleft(pmbP_1 pmbPi_ell(a r_C)pmbI_Cright)^-1pmbb\n\nThus,\n\npmby_ell m(r)\n=\npmbPi_ell(r r_C)\npmbI_C\nleft(pmbP_1 pmbPi_ell(a r_C)pmbI_Cright)^-1\npmbb\n\nTo solve this system we thus need only provide pmbP_1pmby(a^-), we will provide some examples in Chapter 7 at the end of this component.\n\n","category":"section"},{"location":"reference/forcing-frequency/#Reference-(5)","page":"5 - Forcing Frequency","title":"Reference (5)","text":"","category":"section"},{"location":"reference/forcing-frequency/#Forcing-Frequency","page":"5 - Forcing Frequency","title":"Forcing Frequency","text":"Given the fact that the tidal forcing magnitude decreases exponentially with harmonnic order, we limit the calculation to only the lowest harmonnic frequency n = 2. Generally, in the limit of R_p = a, it suffices to only consider the quadrupolar harmonic (n = 2). Moreover, as we are considering a coplanar geometry, terms with ell = 1 associated with obliquity tides vanish. The Fourier modes of the second harmonnic have frequencies given by\n\nsigma = 2Omega - k n_mathrmorb\n\nwhere Omega is spin rate and n_mathrmorb orbital mean motion, and for integer values of k. In our formalism tides are occuring over a large time interval, a time step Delta t. As such, we must account for tidal excitations that occur over a wide range of frequencies. We calculate the imaginary part of the second harmonnic degree (k_2) Love number (Imk_2(sigma)) for a handful of frequencies. The resulting descrete profile can subsequently be interpolated across positive and negative frequencies to yield a continous profile. \n\nNote, since we are only interested in the the Fourier modes of the second harmonnic, we don't actually use the entire spectrum. We can determine which frequencies are relevant using the Hansen Coefficients. \n\nX_22k(e) =\nfrac12pi int_0^2pi\nleft(fracraright)^2\ne^2i v - ikMdM\n\nwhere v is the true anomoly. \n\n","category":"section"},{"location":"reference/rheology/#Reference-(1)","page":"1 - Rheology","title":"Reference (1)","text":"","category":"section"},{"location":"reference/rheology/#Rheology","page":"1 - Rheology","title":"Rheology","text":"The frequency response of the mantle is computed assuming a homogeneous viscoelastic mantle. Obliqua implements two rheological models: Maxwell and Andrade. Unlike the Maxwell model, which captures only elastic–viscous behavior through a single Maxwell timescale, the Andrade rheology includes a transient anelastic component. This yields an elastic response at high forcing frequencies, a viscous response at low frequencies governed by the Maxwell timescale tau_M = eta  mu, and a smooth anelastic transition in between characterized by the Andrade timescale tau_A and creep exponent alpha. As a result, the Andrade rheology reproduces the observed attenuation behavior of planetary mantles more accurately, particularly at high tidal forcing frequencies. The rheologies are incorporated via their definitions of the complex shear modulus. For the Andrade rheology, the complex shear modulus is\n\ntildemu(omega) =\nfracmu\n1 + (mathrmiomegaetamu)^-alphaGamma(1+alpha)\n  + (mathrmiomegaetamu)^-1 qquad alpha = 03\n\nwhere mu is the elastic shear modulus and Gamma the Gamma function.\n\nFor the Maxwell limit alpha = 0 and \n\ntildemu(omega) =\nfracmu1 + (mathrmiomegaetamu)^-1\n\n","category":"section"},{"location":"","page":"Home","title":"Home","text":"    <a href=\"https://opensource.org/license/mit\">\n        <img src=\"https://img.shields.io/badge/License-MIT-blue.svg\">\n    </a>\n    <a href=\"https://arxiv.org/abs/2507.11266\">\n        <img src=\"https://img.shields.io/badge/arXiv-2507.11266-b31b1b\">\n    </a>","category":"section"},{"location":"#Obliqua-(Tidal-heating-model)","page":"Home","title":"Obliqua (Tidal heating model)","text":"A Julia package to calculate the tidal deformation (i.e., tidal Love numbers) of solid, partially-solid, and liquid planetary mantles.\n\nForked from the original repository of Hamish Hay. Distributed under the MIT License.","category":"section"},{"location":"#Documentation","page":"Home","title":"Documentation","text":"https://fwl-proteus.readthedocs.io","category":"section"},{"location":"#Contributors","page":"Home","title":"Contributors","text":"Name Email address\nMarijn van Dijk m.r.van.dijk.3[at]student.rug.nl\nTim Lichtenberg tim.lichtenberg[at]rug.nl\nHarrison Nicholls harrison.nicholls[at]physics.ox.ac.uk\nMohammad Farhat farhat[at]berkeley.edu\nHamish Hay hamish[at]tides.rocks","category":"section"},{"location":"#Repository-structure","page":"Home","title":"Repository structure","text":"README.md           - This file\nLICENSE.txt         - License for modification, distribution, etc.\nsrc/                - Source files\nexamples/           - Tools and notebooks showing how to use the code","category":"section"},{"location":"#Source-code","page":"Home","title":"Source code","text":"GitHub: https://github.com/FormingWorlds/Obliqua\n\nThis software is available under the MIT license","category":"section"},{"location":"#Integrations","page":"Home","title":"Integrations","text":"This project is being developed in close collaboration with the PROTEUS similation framework. Obliqua can be used seamlessly within PROTEUS to model tidal dissipation and Love number evolution in planetary interiors.\n\nFor detailed instructions on installing and using Obliqua in combination with PROTEUS, please refer to the installation guide in the Obliqua documentation.","category":"section"}]
}
